---
title: 途虎2020秋招笔试
date: 2021-05-10 17:20:51
tags:
 - SQL
categories:
 - SQL
---

# 题目描述

订单表tbl_table
![](https://uploadfiles.nowcoder.com/images/20200922/309376_1600775260850_9BEF6F9A3CF4DF7874C3F672A920625C)

用户表tbl_user
![](https://uploadfiles.nowcoder.com/images/20200922/309376_1600775277671_68CCF014DC93ED17F64087E3F8D252DD)

1. 2020年第一季度（1-3月），全国整体业务同比下滑最大三个城市是哪几个？（用sql实现计算逻辑）
2. 公司希望各条业务线完成双十一100%的订单增长目标，帮助供应链团队计算下2020年双十一当天各省不同轮胎需要备多少库存（用sql实现轮胎条数计算的逻辑）


# 题目1

## 查询全国整体业务

```sql
with full as (
    select
        a.salesamount,
        b.city,
        date(a.orderdate) as date
    from
        tbl_table as a
    left join
        tbl_user as b
    on a.user_id = b.user_id
)

```
## 查询2020年第一季度

```sql
with year2020 as (
    select
        city,
        sum(salesamount) as salesamount
    from
        full
    where 
        date between '2020-01-01' and '2020-03-31'
    group by 
        city
)

```
## 查询2019年第一季度

```sql
with year2019 as (
    select
        city,
        sum(salesamount) as salesamount
    from
        full
    where 
        date between '2019-01-01' and '2019-03-31'
    group by 
        city
)

```

## 查看下滑

```sql
    select
        a.city,
        (a.salesamount - b.salesamount) / b.salesamount as diff
    from    
        year2020 as a
    inner join
        year2019 as b
    on a.city = b.city
    order by diff 
    limit 3
```

# 题目2

## 查询219年双十一全国整体业务

```sql
with full2019 as (
    select
        a.salesamount,
        b.province,
        date(a.orderdate) as date
    from
        tbl_table as a
    left join
        tbl_user as b
    on a.user_id = b.user_id
    where 
        date(a.orderdate) = '2019-11-11'
)

```

## 按省拆分

```sql
with province2019 as (
    select
        province,
        sum(salesamount) as salesamount
    from
        full2019
    group by 
        province
)
```

## 预测2020年双11各省

```sql
select
    province,
    salesamount * 2 as salesamount
from
    province2019
```