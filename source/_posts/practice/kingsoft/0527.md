---
title: 5月27日工作内容
date: 2021-05-27 17:02:04
tags:
 - 实习
categories:
 - 金山实习
---

# 撰写数据分析报告

在excel里面画了很多图，分析得很详细，区别了`租金`、`日期`、`dont ask again`,但是在数据分析报告中，由于做的是月度复盘，需要讲
上一个月内每一个版本迭代过程都要去复述一遍，因此讲求从大题把握，而不是针对某一个专题来进行的分析，所以力求精简。

# 13.8 安卓-添加桌面快捷方式

```SQL
declare start_date default '0409';
declare end_date default '0429';


with add_homescreen as (
    select
        event_date,
        case 
            when lower(comp)  like '%doc%' then 'DOC'
            when lower(comp) like '%ppt%' then 'PPT'
            when lower(comp) like '%xls%' then 'ET'
            when lower(comp) like '%et%' then 'ET'
            when lower(comp) like '%pdf%' then 'PDF'
            else 'other'
        end as comp,
        position,
        count(distinct user_pseudo_id) as uv
    from (
        select
            event_date,
            user_pseudo_id,
            (SELECT value.string_value FROM UNNEST(event_params) WHERE key='comp') as comp, # 组件
            (SELECT value.string_value FROM UNNEST(event_params) WHERE key='position') as position # 触发方式
        from
            `wps-cloud-service.analytics_153386958.events_2021*`
        where 
            _table_suffix >= start_date and _table_suffix <= end_date and
            event_name = 'page_show' and
            app_info.version = '13.8' and
            (SELECT value.string_value FROM UNNEST(event_params) WHERE key='func_name') = 'add_homescreen_show'
    ) as a
    group by
        event_date, comp, position
    order by
        event_date, comp, position
    
),
click_add_base as (
    select
        event_date,
        user_pseudo_id,
        (SELECT value.string_value FROM UNNEST(event_params) WHERE key='data1') as if_ok, # 是否添加成功
        (SELECT value.string_value FROM UNNEST(event_params) WHERE key='comp') as comp, # 组件
        (SELECT value.string_value FROM UNNEST(event_params) WHERE key='stat') as if_ask_agagin, # 表示是否勾选了Dont ask me again
        (SELECT value.string_value FROM UNNEST(event_params) WHERE key='position') as position # 触发方式
    from
        `wps-cloud-service.analytics_153386958.events_2021*`
    where 
        _table_suffix >= start_date and _table_suffix <= end_date and
        event_name = 'button_click' and
        app_info.version = '13.8' and
        (SELECT value.string_value FROM UNNEST(event_params) WHERE key='func_name') = 'add_homescreen_add'
),
click_no_base as (
    select
        event_date,
        user_pseudo_id,
        (SELECT value.string_value FROM UNNEST(event_params) WHERE key='data1') as if_ok, # 是否添加成功
        (SELECT value.string_value FROM UNNEST(event_params) WHERE key='comp') as comp, # 组件
        (SELECT value.string_value FROM UNNEST(event_params) WHERE key='stat') as if_ask_agagin, # 表示是否勾选了Dont ask me again
        (SELECT value.string_value FROM UNNEST(event_params) WHERE key='position') as position # 触发方式
    from
        `wps-cloud-service.analytics_153386958.events_2021*`
    where 
        _table_suffix >= start_date and _table_suffix <= end_date and
        event_name = 'button_click' and
        app_info.version = '13.8' and
        (SELECT value.string_value FROM UNNEST(event_params) WHERE key='func_name') = 'add_homescreen_no'
),
click_add as (
    select
        'click_add' as click_name,
        event_date,
        case 
            when lower(comp)  like '%doc%' then 'DOC'
            when lower(comp) like '%ppt%' then 'PPT'
            when lower(comp) like '%xls%' then 'ET'
            when lower(comp) like '%et%' then 'ET'
            when lower(comp) like '%pdf%' then 'PDF'
            else 'other'
        end as comp,
        position,
        if_ask_agagin,
        if_ok,
        count(distinct user_pseudo_id) as uv

    from
        click_add_base 
    group by 
        event_date,
        comp,
        position,
        if_ask_agagin,
        if_ok
    order by
        event_date,
        comp,
        position,
        if_ask_agagin,
        if_ok
),
click_no as (
    select
        'click_no' as click_name,
        event_date,
        case 
            when lower(comp)  like '%doc%' then 'DOC'
            when lower(comp) like '%ppt%' then 'PPT'
            when lower(comp) like '%xls%' then 'ET'
            when lower(comp) like '%et%' then 'ET'
            when lower(comp) like '%pdf%' then 'PDF'
            else 'other'
        end as comp,
        position,
        if_ask_agagin,
        if_ok,
        count(distinct user_pseudo_id) as uv
    from
        click_no_base 
    group by 
        event_date,
        comp,
        position,
        if_ask_agagin,
        if_ok
    order by
        event_date,
        comp,
        position,
        if_ask_agagin,
        if_ok  
)

#select * from add_homescreen
#select * from click_no 
select * from click_add


```


