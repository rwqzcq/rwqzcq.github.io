---
title: 5月24日实习内容
date: 2021-05-24 10:13:29
tags:
 - 实习
categories:
- 金山实习
---

# PC端安卓端核心指标汇总，SQL文件整合

核心的逻辑都是一样的，比如，主要是做`union all`,为了方式在安卓端那里加上`japan`有重复，所以可以用`union distinct`

```sql
select
    *
from (
    select
        'share' as metrics,
        country,
        date,
        count(distinct google_id) as uv
    from 
        `wps-data-analysis.wps_active.android_core_feature_share`
    where
        country in (select country from top40_country) and
        date >= end_date and date < start_date
    group by
        country,
        date
    order by
        country,
        date 
) as each_country
union all (
    select
        'share' as metrics,
        'all' as country,
        date,
        count(distinct google_id) as uv
    from
        `wps-data-analysis.wps_active.android_core_feature_share`
    where
        date >= end_date and date < start_date
    group by
        date
    order by date
)
```

# Excel数据去重

由于需要做到在某一块区域中粘贴数据后会自动计算相关的指标值，所以就不能像原来那样`点击筛选按钮筛选出所有的国家，然后再把国家复制到对应的栏目中`，这种方式
还是不够智能，因为很有可能的是不同的时期active总量在前40的国家为动态变化的，所以需要自动来筛选出所有的国家。
去重的方式选择的是使用数据透视表，把`country`作为行，`metrics`作为列，`uv`作为求和项来做。但是这种也并不是完全的智能化。
在下一次粘贴数据的时候还需要注意的是、
> 需要更新数据透视表

# 参考链接
1. excel去重.https://blog.csdn.net/STR_Liang/article/details/105182654