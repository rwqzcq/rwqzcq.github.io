<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>rwqccnuimd的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="rwqccnuimd的博客">
<meta property="og:url" content="http://example.com/page/15/index.html">
<meta property="og:site_name" content="rwqccnuimd的博客">
<meta property="og:locale">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="rwqccnuimd的博客" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">rwqccnuimd的博客</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Suche"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Suche"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-yewu/liucun" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/05/11/yewu/liucun/" class="article-date">
  <time class="dt-published" datetime="2021-05-11T06:47:39.000Z" itemprop="datePublished">2021-05-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E4%B8%9A%E5%8A%A1/">业务</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/05/11/yewu/liucun/">留存分析</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="1-留存率为什么很重要"><a href="#1-留存率为什么很重要" class="headerlink" title="1. 留存率为什么很重要"></a>1. 留存率为什么很重要</h1><p><img src="https://pic4.zhimg.com/80/v2-2d83faf0d8515830edc3d1be5c10380b_1440w.jpg"></p>
<p>留存率对于用户增长有着重要的影响，那么什么样的产品需要关注留存：</p>
<p><img src="http://image.woshipm.com/wp-files/2019/10/txMR8HL3ti7ZBzNruiCP.png"></p>
<h1 id="2-留存分析方法"><a href="#2-留存分析方法" class="headerlink" title="2. 留存分析方法"></a>2. 留存分析方法</h1><h2 id="2-1-漏斗分析"><a href="#2-1-漏斗分析" class="headerlink" title="2.1 漏斗分析"></a>2.1 漏斗分析</h2><p>根据用户的旅程划分出不同的留存阶段。</p>
<p><img src="https://pic1.zhimg.com/80/v2-d6e966ac98607017dd426257675b0c70_1440w.jpg"></p>
<ul>
<li>短期阶段：关注用户的<code>激活</code>行为，让用户迅速体验到产品的核心价值。</li>
<li>中期阶段：关注<code>老用户</code>的留存提升，打造产品的核心功能，培养用户使用习惯。</li>
<li>长期阶段：思考产品对用户的<code>长期价值</code>。</li>
</ul>
<h2 id="2-2-用户维度考虑"><a href="#2-2-用户维度考虑" class="headerlink" title="2.2 用户维度考虑"></a>2.2 用户维度考虑</h2><ul>
<li>新老用户</li>
<li>渠道</li>
<li>用户消费能力</li>
</ul>
<h1 id="3-例题"><a href="#3-例题" class="headerlink" title="3. 例题"></a>3. 例题</h1><h2 id="3-1-某日次日留存下降百分之5怎么分析？"><a href="#3-1-某日次日留存下降百分之5怎么分析？" class="headerlink" title="3.1 某日次日留存下降百分之5怎么分析？"></a>3.1 某日次日留存下降百分之5怎么分析？</h2><p>采用<code>两层模型</code>进行分析，对用户进行细分，可以按照<code>新老用户</code>、<code>渠道</code>、<code>活动</code>等维度来看，计算不同维度下用户的次日留存率，从而定位哪一用户群体的留存下降最快，明确目标用户。</p>
<p>对于目标用户群体分析，具体情况具体分析。可以采用<code>内部-外部</code>方式进行分析。</p>
<p>内部包括</p>
<ul>
<li>获客<ul>
<li>渠道质量，获取到的客户是否为目标客户</li>
</ul>
</li>
<li>功能<ul>
<li>功能是否满足需求</li>
</ul>
</li>
<li>提活手段<ul>
<li>签到等提活手段没达成目标，<code>产品自然使用周期低</code>导致上次获得的大量用户短期内不需要再使用等等</li>
</ul>
</li>
</ul>
<p>外部包括：</p>
<ul>
<li>政治</li>
<li>经济<ul>
<li>竞争对手</li>
</ul>
</li>
<li>社会<ul>
<li>舆论</li>
<li>消费心理</li>
<li>价值观变化</li>
</ul>
</li>
<li>技术<ul>
<li>创新解决方案的出现</li>
</ul>
</li>
</ul>
<p><img src="0.png"></p>
<h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><ul>
<li><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1pU4y187fC?from=search&amp;seid=15325016540219605079">https://www.bilibili.com/video/BV1pU4y187fC?from=search&amp;seid=15325016540219605079</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/hu_wenqiong/article/details/98634402?utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.control&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromMachineLearnPai2~default-1.control">https://blog.csdn.net/hu_wenqiong/article/details/98634402?utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control</a></li>
<li><a target="_blank" rel="noopener" href="http://www.woshipm.com/operate/3000870.html">http://www.woshipm.com/operate/3000870.html</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/05/11/yewu/liucun/" data-id="cl85d5h6c00awi99o47t43rzw" data-title="留存分析" class="article-share-link">Teilen</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E4%B8%9A%E5%8A%A1/" rel="tag">业务</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-yewu/user_clf" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/05/11/yewu/user_clf/" class="article-date">
  <time class="dt-published" datetime="2021-05-11T06:47:12.000Z" itemprop="datePublished">2021-05-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/05/11/yewu/user_clf/">用户群体划分</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/05/11/yewu/user_clf/" data-id="cl85d5h6f00b3i99od52a5vr7" data-title="用户群体划分" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-tongji/ab_test" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/05/11/tongji/ab_test/" class="article-date">
  <time class="dt-published" datetime="2021-05-11T06:26:00.000Z" itemprop="datePublished">2021-05-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/05/11/tongji/ab_test/">A/B测试</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/05/11/tongji/ab_test/" data-id="cl85d5h6400a3i99o5dinca5x" data-title="A/B测试" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-sql/tuhu2020" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/05/10/sql/tuhu2020/" class="article-date">
  <time class="dt-published" datetime="2021-05-10T09:20:51.000Z" itemprop="datePublished">2021-05-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/SQL/">SQL</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/05/10/sql/tuhu2020/">途虎2020秋招笔试</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><p>订单表tbl_table<br><img src="https://uploadfiles.nowcoder.com/images/20200922/309376_1600775260850_9BEF6F9A3CF4DF7874C3F672A920625C"></p>
<p>用户表tbl_user<br><img src="https://uploadfiles.nowcoder.com/images/20200922/309376_1600775277671_68CCF014DC93ED17F64087E3F8D252DD"></p>
<ol>
<li>2020年第一季度（1-3月），全国整体业务同比下滑最大三个城市是哪几个？（用sql实现计算逻辑）</li>
<li>公司希望各条业务线完成双十一100%的订单增长目标，帮助供应链团队计算下2020年双十一当天各省不同轮胎需要备多少库存（用sql实现轮胎条数计算的逻辑）</li>
</ol>
<h1 id="题目1"><a href="#题目1" class="headerlink" title="题目1"></a>题目1</h1><h2 id="查询全国整体业务"><a href="#查询全国整体业务" class="headerlink" title="查询全国整体业务"></a>查询全国整体业务</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="keyword">full</span> <span class="keyword">as</span> (</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        a.salesamount,</span><br><span class="line">        b.city,</span><br><span class="line">        <span class="type">date</span>(a.orderdate) <span class="keyword">as</span> <span class="type">date</span></span><br><span class="line">    <span class="keyword">from</span></span><br><span class="line">        tbl_table <span class="keyword">as</span> a</span><br><span class="line">    <span class="keyword">left</span> <span class="keyword">join</span></span><br><span class="line">        tbl_user <span class="keyword">as</span> b</span><br><span class="line">    <span class="keyword">on</span> a.user_id <span class="operator">=</span> b.user_id</span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="查询2020年第一季度"><a href="#查询2020年第一季度" class="headerlink" title="查询2020年第一季度"></a>查询2020年第一季度</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> year2020 <span class="keyword">as</span> (</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        city,</span><br><span class="line">        <span class="built_in">sum</span>(salesamount) <span class="keyword">as</span> salesamount</span><br><span class="line">    <span class="keyword">from</span></span><br><span class="line">        <span class="keyword">full</span></span><br><span class="line">    <span class="keyword">where</span> </span><br><span class="line">        <span class="type">date</span> <span class="keyword">between</span> <span class="string">&#x27;2020-01-01&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;2020-03-31&#x27;</span></span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> </span><br><span class="line">        city</span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="查询2019年第一季度"><a href="#查询2019年第一季度" class="headerlink" title="查询2019年第一季度"></a>查询2019年第一季度</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> year2019 <span class="keyword">as</span> (</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        city,</span><br><span class="line">        <span class="built_in">sum</span>(salesamount) <span class="keyword">as</span> salesamount</span><br><span class="line">    <span class="keyword">from</span></span><br><span class="line">        <span class="keyword">full</span></span><br><span class="line">    <span class="keyword">where</span> </span><br><span class="line">        <span class="type">date</span> <span class="keyword">between</span> <span class="string">&#x27;2019-01-01&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;2019-03-31&#x27;</span></span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> </span><br><span class="line">        city</span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="查看下滑"><a href="#查看下滑" class="headerlink" title="查看下滑"></a>查看下滑</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    a.city,</span><br><span class="line">    (a.salesamount <span class="operator">-</span> b.salesamount) <span class="operator">/</span> b.salesamount <span class="keyword">as</span> diff</span><br><span class="line"><span class="keyword">from</span>    </span><br><span class="line">    year2020 <span class="keyword">as</span> a</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span></span><br><span class="line">    year2019 <span class="keyword">as</span> b</span><br><span class="line"><span class="keyword">on</span> a.city <span class="operator">=</span> b.city</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> diff </span><br><span class="line">limit <span class="number">3</span></span><br></pre></td></tr></table></figure>

<h1 id="题目2"><a href="#题目2" class="headerlink" title="题目2"></a>题目2</h1><h2 id="查询219年双十一全国整体业务"><a href="#查询219年双十一全国整体业务" class="headerlink" title="查询219年双十一全国整体业务"></a>查询219年双十一全国整体业务</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> full2019 <span class="keyword">as</span> (</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        a.salesamount,</span><br><span class="line">        b.province,</span><br><span class="line">        <span class="type">date</span>(a.orderdate) <span class="keyword">as</span> <span class="type">date</span></span><br><span class="line">    <span class="keyword">from</span></span><br><span class="line">        tbl_table <span class="keyword">as</span> a</span><br><span class="line">    <span class="keyword">left</span> <span class="keyword">join</span></span><br><span class="line">        tbl_user <span class="keyword">as</span> b</span><br><span class="line">    <span class="keyword">on</span> a.user_id <span class="operator">=</span> b.user_id</span><br><span class="line">    <span class="keyword">where</span> </span><br><span class="line">        <span class="type">date</span>(a.orderdate) <span class="operator">=</span> <span class="string">&#x27;2019-11-11&#x27;</span></span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="按省拆分"><a href="#按省拆分" class="headerlink" title="按省拆分"></a>按省拆分</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> province2019 <span class="keyword">as</span> (</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        province,</span><br><span class="line">        <span class="built_in">sum</span>(salesamount) <span class="keyword">as</span> salesamount</span><br><span class="line">    <span class="keyword">from</span></span><br><span class="line">        full2019</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> </span><br><span class="line">        province</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h2 id="预测2020年双11各省"><a href="#预测2020年双11各省" class="headerlink" title="预测2020年双11各省"></a>预测2020年双11各省</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    province,</span><br><span class="line">    salesamount <span class="operator">*</span> <span class="number">2</span> <span class="keyword">as</span> salesamount</span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">    province2019</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/05/10/sql/tuhu2020/" data-id="cl85d5h61009ti99ofpvw2djw" data-title="途虎2020秋招笔试" class="article-share-link">Teilen</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SQL/" rel="tag">SQL</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-sql/niuke-70" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/05/10/sql/niuke-70/" class="article-date">
  <time class="dt-published" datetime="2021-05-10T07:55:06.000Z" itemprop="datePublished">2021-05-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/SQL/">SQL</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/05/10/sql/niuke-70/">牛客网70题-求每一天新用户的留存率</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><p><a href="%E5%8E%9F%E5%A7%8B%E9%93%BE%E6%8E%A5">https://www.nowcoder.com/practice/ea0c56cd700344b590182aad03cc61b8?tpId=82&amp;tqId=35088&amp;rp=1&amp;ru=%2Factivity%2Foj&amp;qru=%2Fta%2Fsql%2Fquestion-ranking&amp;tab=answerKey</a><br>牛客每天有很多人登录，请你统计一下牛客每个日期新用户的次日留存率。<br>有一个登录(login)记录表，简况如下:<br><img src="https://uploadfiles.nowcoder.com/images/20200820/557336_1597903752757_A02F3DF1419BC2D3D4EE9B2B4557053B"><br>第1行表示user_id为2的用户在2020-10-12使用了客户端id为1的设备登录了牛客网，因为是第1次登录，所以是新用户<br>。。。<br>第4行表示user_id为2的用户在2020-10-13使用了客户端id为2的设备登录了牛客网，因为是第2次登录，所以是老用户<br>。。<br>最后1行表示user_id为4的用户在2020-10-15使用了客户端id为1的设备登录了牛客网，因为是第2次登录，所以是老用户</p>
<p>请你写出一个sql语句查询每个日期新用户的次日留存率，结果保留小数点后面3位数(3位之后的四舍五入)，并且查询结果按照日期升序排序，上面的例子查询结果如下:<br><img src="https://uploadfiles.nowcoder.com/images/20200820/557336_1597903761838_F734DB69B9941F0DF86776922B0CF347"><br>查询结果表明:<br>2020-10-12登录了3个(user_id为2，3，1)新用户，2020-10-13，只有2个(id为2,1)登录，故2020-10-12新用户次日留存率为2/3=0.667;<br>2020-10-13没有新用户登录，输出0.000;<br>2020-10-14登录了1个(user_id为4)新用户，2020-10-15，user_id为4的用户登录，故2020-10-14新用户次日留存率为1/1=1.000;<br>2020-10-15没有新用户登录，输出0.000;<br>(注意:sqlite里查找某一天的后一天的用法是:date(yyyy-mm-dd, ‘+1 day’)，sqlite里1/2得到的不是0.5，得到的是0，只有1*1.0/2才会得到0.5)</p>
<h1 id="输入"><a href="#输入" class="headerlink" title="输入"></a>输入</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> login;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `login` (</span><br><span class="line">`id` <span class="type">int</span>(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`user_id` <span class="type">int</span>(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`client_id` <span class="type">int</span>(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`<span class="type">date</span>` <span class="type">date</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"><span class="keyword">PRIMARY</span> KEY (`id`));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> login <span class="keyword">VALUES</span></span><br><span class="line">(<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="string">&#x27;2020-10-12&#x27;</span>),</span><br><span class="line">(<span class="number">2</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="string">&#x27;2020-10-12&#x27;</span>),</span><br><span class="line">(<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="string">&#x27;2020-10-12&#x27;</span>),</span><br><span class="line">(<span class="number">4</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="string">&#x27;2020-10-13&#x27;</span>),</span><br><span class="line">(<span class="number">5</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="string">&#x27;2020-10-13&#x27;</span>),</span><br><span class="line">(<span class="number">6</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="string">&#x27;2020-10-14&#x27;</span>),</span><br><span class="line">(<span class="number">7</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="string">&#x27;2020-10-14&#x27;</span>),</span><br><span class="line">(<span class="number">8</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="string">&#x27;2020-10-15&#x27;</span>);</span><br></pre></td></tr></table></figure>
<h1 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2020</span><span class="number">-10</span><span class="number">-12</span><span class="operator">|</span><span class="number">0.667</span></span><br><span class="line"><span class="number">2020</span><span class="number">-10</span><span class="number">-13</span><span class="operator">|</span><span class="number">0.000</span></span><br><span class="line"><span class="number">2020</span><span class="number">-10</span><span class="number">-14</span><span class="operator">|</span><span class="number">1.000</span></span><br><span class="line"><span class="number">2020</span><span class="number">-10</span><span class="number">-15</span><span class="operator">|</span><span class="number">0.000</span></span><br></pre></td></tr></table></figure>

<h1 id="解题"><a href="#解题" class="headerlink" title="解题"></a>解题</h1><blockquote>
<p>注意是查找每一个日期<code>新用户</code>的留存</p>
</blockquote>
<h2 id="错误写法"><a href="#错误写法" class="headerlink" title="错误写法"></a>错误写法</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">    a.date</span><br><span class="line">    round(</span><br><span class="line">        <span class="built_in">count</span>(<span class="keyword">distinct</span> b.user_id) <span class="operator">/</span> <span class="built_in">count</span>(<span class="keyword">distinct</span> a.user_id),</span><br><span class="line">        <span class="number">3</span></span><br><span class="line">    ) <span class="keyword">as</span> p</span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">    user_login <span class="keyword">as</span> a</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> </span><br><span class="line">    user_login <span class="keyword">as</span> b</span><br><span class="line"><span class="keyword">on</span> </span><br><span class="line">    a.user_id <span class="operator">=</span> b.user_id <span class="keyword">and</span></span><br><span class="line">    datediff(b.date, a.date) <span class="operator">=</span> <span class="number">1</span> <span class="comment">-- 相隔1天</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> a.date</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="type">date</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>这里写的错误的原因在于没有在日期中区分出来新的用户</p>
</blockquote>
<h2 id="正确写法1"><a href="#正确写法1" class="headerlink" title="正确写法1"></a>正确写法1</h2><h3 id="查询出每一个用户的最早登录日期"><a href="#查询出每一个用户的最早登录日期" class="headerlink" title="查询出每一个用户的最早登录日期"></a>查询出每一个用户的最早登录日期</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">with</span> user_first_login <span class="keyword">as</span> (</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        user_id,</span><br><span class="line">        <span class="built_in">min</span>(<span class="type">date</span>) <span class="keyword">as</span> <span class="type">date</span></span><br><span class="line">    <span class="keyword">from</span> </span><br><span class="line">        user_login</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> user_id</span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="查询出所有日期"><a href="#查询出所有日期" class="headerlink" title="查询出所有日期"></a>查询出所有日期</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> all_date <span class="keyword">as</span> (</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        <span class="keyword">distinct</span> <span class="type">date</span></span><br><span class="line">    <span class="keyword">from</span></span><br><span class="line">        user_login</span><br><span class="line">    <span class="keyword">order</span> <span class="keyword">by</span> </span><br><span class="line">        <span class="type">date</span> </span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h3 id="在每一个日期中过滤掉老用户"><a href="#在每一个日期中过滤掉老用户" class="headerlink" title="在每一个日期中过滤掉老用户"></a>在每一个日期中过滤掉老用户</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> date_retention <span class="keyword">as</span> (</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        a.date</span><br><span class="line">        round(</span><br><span class="line">            <span class="built_in">count</span>(<span class="keyword">distinct</span> b.user_id) <span class="operator">/</span> <span class="built_in">count</span>(<span class="keyword">distinct</span> a.user_id),</span><br><span class="line">            <span class="number">3</span></span><br><span class="line">        ) <span class="keyword">as</span> p</span><br><span class="line">    <span class="keyword">from</span></span><br><span class="line">        user_login <span class="keyword">as</span> a</span><br><span class="line">    <span class="keyword">left</span> <span class="keyword">join</span> </span><br><span class="line">        user_login <span class="keyword">as</span> b</span><br><span class="line">    <span class="keyword">on</span> </span><br><span class="line">        a.user_id <span class="operator">=</span> b.user_id <span class="keyword">and</span></span><br><span class="line">        datediff(b.date, a.date) <span class="operator">=</span> <span class="number">1</span> <span class="comment">-- 相隔1天</span></span><br><span class="line">    <span class="keyword">where</span> </span><br><span class="line">        <span class="keyword">exists</span> (</span><br><span class="line">            <span class="keyword">select</span></span><br><span class="line">                <span class="operator">*</span></span><br><span class="line">            <span class="keyword">from</span> </span><br><span class="line">                user_first_login <span class="keyword">as</span> c</span><br><span class="line">            <span class="keyword">where</span> </span><br><span class="line">                c.user_id <span class="operator">=</span> a.user_id <span class="keyword">and</span></span><br><span class="line">                c.date <span class="operator">=</span> a.date</span><br><span class="line">        )</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> </span><br><span class="line">        a.date</span><br><span class="line">    <span class="keyword">order</span> <span class="keyword">by</span> <span class="type">date</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="合并所有日期"><a href="#合并所有日期" class="headerlink" title="合并所有日期"></a>合并所有日期</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    a.date,</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">when</span> b.p <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">then</span> <span class="number">0.000</span> <span class="keyword">else</span> b <span class="keyword">end</span> <span class="keyword">as</span> p</span><br><span class="line"><span class="keyword">from</span> </span><br><span class="line">    all_date <span class="keyword">as</span> a</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> </span><br><span class="line">    date_retention  <span class="keyword">as</span> b</span><br><span class="line"><span class="keyword">on</span> </span><br><span class="line">    a.date <span class="operator">=</span> b.date</span><br></pre></td></tr></table></figure>

<h2 id="正确解法2"><a href="#正确解法2" class="headerlink" title="正确解法2"></a>正确解法2</h2><h3 id="找到所有新用户与首次登录日期"><a href="#找到所有新用户与首次登录日期" class="headerlink" title="找到所有新用户与首次登录日期"></a>找到所有新用户与首次登录日期</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> user_first_login <span class="keyword">as</span> (</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        user_id,</span><br><span class="line">        <span class="built_in">min</span>(<span class="type">date</span>) <span class="keyword">as</span> <span class="type">date</span></span><br><span class="line">    <span class="keyword">from</span> </span><br><span class="line">        login</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> user_id</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h3 id="原表与新用户表链接-这是最巧妙的地方"><a href="#原表与新用户表链接-这是最巧妙的地方" class="headerlink" title="原表与新用户表链接(这是最巧妙的地方)"></a>原表与新用户表链接(这是最巧妙的地方)</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> date_retention <span class="keyword">as</span> (</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        a.date,</span><br><span class="line">        round(</span><br><span class="line">            <span class="built_in">count</span>(b.user_id) <span class="operator">/</span> <span class="built_in">count</span>(a.user_id),</span><br><span class="line">            <span class="number">3</span></span><br><span class="line">        )</span><br><span class="line">    <span class="keyword">from</span> </span><br><span class="line">        user_first_login <span class="keyword">as</span> a</span><br><span class="line">    <span class="keyword">left</span> <span class="keyword">join</span> </span><br><span class="line">        login <span class="keyword">as</span> b</span><br><span class="line">    <span class="keyword">on</span> </span><br><span class="line">        a.user_id <span class="operator">=</span> b.user_id <span class="keyword">and</span></span><br><span class="line">        datediff(b.date, a.date) <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> </span><br><span class="line">        a.date</span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="利用union-补全日期"><a href="#利用union-补全日期" class="headerlink" title="利用union 补全日期"></a>利用union 补全日期</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">    <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> date_retention</span><br><span class="line"><span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">(</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        <span class="keyword">distinct</span> <span class="type">date</span>,</span><br><span class="line">        <span class="number">0.000</span> <span class="keyword">as</span> p</span><br><span class="line">    <span class="keyword">from</span> </span><br><span class="line">        user_login</span><br><span class="line">    <span class="keyword">where</span></span><br><span class="line">        <span class="type">date</span> <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">select</span> <span class="type">date</span> <span class="keyword">from</span> user_first_login)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span></span><br><span class="line">    <span class="type">date</span></span><br></pre></td></tr></table></figure>



      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/05/10/sql/niuke-70/" data-id="cl85d5h5x009fi99o262sc7r9" data-title="牛客网70题-求每一天新用户的留存率" class="article-share-link">Teilen</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SQL/" rel="tag">SQL</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-sql/niuke-57" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/05/10/sql/niuke-57/" class="article-date">
  <time class="dt-published" datetime="2021-05-10T06:50:52.000Z" itemprop="datePublished">2021-05-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/SQL/">SQL</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/05/10/sql/niuke-57/">牛客网SQL第5题-含有关键字exists查找未分配具体部门的员工的所有信息</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><p><a target="_blank" rel="noopener" href="https://www.nowcoder.com/practice/c39cbfbd111a4d92b221acec1c7c1484?tpId=82&tqId=29825&rp=1&ru=/activity/oj&qru=/ta/sql/question-ranking&tab=answerKey">原始链接</a><br>使用含有关键字exists查找未分配具体部门的员工的所有信息。</p>
<h1 id="输入"><a href="#输入" class="headerlink" title="输入"></a>输入</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `employees` (</span><br><span class="line">`emp_no` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`birth_date` <span class="type">date</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`first_name` <span class="type">varchar</span>(<span class="number">14</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`last_name` <span class="type">varchar</span>(<span class="number">16</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`gender` <span class="type">char</span>(<span class="number">1</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`hire_date` <span class="type">date</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"><span class="keyword">PRIMARY</span> KEY (`emp_no`));</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `dept_emp` (</span><br><span class="line">`emp_no` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`dept_no` <span class="type">char</span>(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`from_date` <span class="type">date</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`to_date` <span class="type">date</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"><span class="keyword">PRIMARY</span> KEY (`emp_no`,`dept_no`));</span><br></pre></td></tr></table></figure>

<h1 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h1><p>输出格式</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">emp_no	birth_date	first_name	last_name	gender	hire_date</span><br><span class="line">10011	1953-11-07	Mary	Sluis	F	1990-01-22</span><br></pre></td></tr></table></figure>

<h1 id="解题"><a href="#解题" class="headerlink" title="解题"></a>解题</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">      <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">    employees</span><br><span class="line"><span class="keyword">where</span> </span><br><span class="line">    <span class="keyword">not</span> <span class="keyword">exists</span> (</span><br><span class="line">        <span class="keyword">select</span> </span><br><span class="line">            emp_no</span><br><span class="line">        <span class="keyword">from</span> </span><br><span class="line">            dept_emp</span><br><span class="line">        <span class="keyword">where</span> </span><br><span class="line">            dept_emp.emp_no <span class="operator">=</span> employees.emp_no <span class="comment">-- 这里是核心</span></span><br><span class="line">    )</span><br></pre></td></tr></table></figure>

<h1 id="exists使用"><a href="#exists使用" class="headerlink" title="exists使用"></a>exists使用</h1><p>Exists的用法：</p>
<ol>
<li>exists对外表用loop逐条查询，每次查询都会查看exists的条件语句，当</li>
<li>exists里的条件语句能够返回记录行时(无论记录行是的多少，只要能返回)，条件就为真，返回当前loop到的这条记录;</li>
<li>反之如果exists里的条 件语句不能返回记录行，则当前loop到的这条记录被丢弃，</li>
<li>exists的条件就像一个bool条件，当能返回结果集则为true，不能返回结果集则为 false。</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/05/10/sql/niuke-57/" data-id="cl85d5h5v009bi99o45051wdj" data-title="牛客网SQL第5题-含有关键字exists查找未分配具体部门的员工的所有信息" class="article-share-link">Teilen</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SQL/" rel="tag">SQL</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-ml/logistic_regression" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/05/10/ml/logistic_regression/" class="article-date">
  <time class="dt-published" datetime="2021-05-10T06:33:10.000Z" itemprop="datePublished">2021-05-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/05/10/ml/logistic_regression/">逻辑回归</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><h2 id="一句话概括"><a href="#一句话概括" class="headerlink" title="一句话概括"></a>一句话概括</h2><p>逻辑回归假设数据服从<code>伯努利分布</code>，通过<code>极大化似然函数</code>的方法，运用<code>梯度下降</code>来求解参数，来达到将<code>数据二分类</code>的目的。</p>
<h2 id="假设"><a href="#假设" class="headerlink" title="假设"></a>假设</h2><p>逻辑回归假设数据服从伯努利分布，伯努利分布有一个简单的例子是抛硬币，抛中为正面的概率是p,抛中为负面的概率是1−p。<br>在逻辑回归这个模型里面是假设 hθ(x) 为样本为正的概率，1−hθ(x)为样本为负的概率。</p>
<h2 id="如何做分类"><a href="#如何做分类" class="headerlink" title="如何做分类"></a>如何做分类</h2><p>逻辑回归作为一个回归(也就是y值是连续的)，如何应用到分类上去呢。<br>y值确实是一个<code>连续的变量</code>。逻辑回归的做法是<code>划定一个阈值</code>，y值大于这个阈值的是一类，y值小于这个阈值的是另外一类。<br>阈值具体如何调整根据实际情况选择。一般会选择0.5做为阈值来划分。</p>
<h1 id="线性回归与逻辑回归的区别"><a href="#线性回归与逻辑回归的区别" class="headerlink" title="线性回归与逻辑回归的区别"></a>线性回归与逻辑回归的区别</h1><ol>
<li>线性回归的变量服从0-1正态分布，而逻辑回归的变量服从伯努利分布。</li>
<li>线性回归要求<code>因变量</code>是<code>连续性数值变量</code>，而逻辑回归要求因变量是<code>分类型变量</code>。</li>
<li>线性回归要求自变量和因变量呈线性关系，而逻辑回归不要求自变量和因变量呈线性关系。</li>
<li>逻辑回归是分析因变量<code>取某个值的概率</code>与自变量的关系，而线性回归是直接分析因变量与自变量的关系。</li>
</ol>
<h1 id="正则化"><a href="#正则化" class="headerlink" title="正则化"></a>正则化</h1><p>降低过拟合。过拟合表现在训练数据上的误差非常小，而在测试数据上误差反而增大。<br>原因是模型过于复杂，过分的去拟合数据的噪声。<br>正则化项是对模型参数添加先验，使得模型复杂度较小，对于噪声扰动相对较小。<br>在目标函数或代价函数后面加上一个正则项，一般有L1正则与L2正则。</p>
<h2 id="L1"><a href="#L1" class="headerlink" title="L1"></a>L1</h2><p><img src="https://img-blog.csdnimg.cn/20190826120845495.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NpbmF0XzMzMjMxNTcz,size_16,color_FFFFFF,t_70"><br>L1 正则的本质其实是为模型增加了“模型参数服从零均值拉普拉斯分布”这一先验知识。<br>L1能够精确地评价每一个特征对于损失函数结果的影响程度，对于影响程度小的特征，它直接把他们的系数θi归零！</p>
<h2 id="L2"><a href="#L2" class="headerlink" title="L2"></a>L2</h2><p>L2 正则的本质其实是为模型增加了“模型参数服从零均值正态分布”这一先验知识。<br>L2 正则化中增加所有权重 w 参数的平方之和，逼迫所有 w 尽可能趋向零但不为零（L2 的导数趋于零）。<br>因为在未加入 L2 正则化发生过拟合时，拟合函数需要顾忌每一个点，最终形成的拟合函数波动很大，在某些很小的区间里，函数值的变化很剧烈，也就是某些 w 值非常大。为此，L2 正则化的加入就惩罚了权重变大的趋势。</p>
<h1 id="优缺点"><a href="#优缺点" class="headerlink" title="优缺点"></a>优缺点</h1><h2 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h2><ol>
<li>形式简单，模型的<code>可解释性</code>非常好。从<code>特征的权重</code>可以看到不同的特征对最后结果的影响，某个特征的权重值比较高，那么这个特征最后对结果的影响会比较大。</li>
<li>训练速度较快。分类的时候，计算量仅仅只和<code>特征的数目</code>相关。并且逻辑回归的分布式优化sgd发展比较成熟，训练的速度可以通过堆机器进一步提高，这样我们可以在短时间内迭代好几个版本的模型。</li>
<li>资源占用小,尤其是内存。因为只需要存储各个维度的特征值。</li>
</ol>
<h2 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h2><ol>
<li>准确率并不是很高。因为形式非常的简单(非常类似线性模型)，很难去拟合数据的真实分布。</li>
<li>很难处理数据不平衡的问题。举个例子：如果我们对于一个正负样本非常不平衡的问题比如正负样本比<br>10000:1.我们把所有样本都预测为正也能使损失函数的值比较小。但是作为一个分类器，它对正负样本的区分能力不会很好。</li>
<li>较难去处理非线性数据。</li>
<li>逻辑回归本身无法筛选特征。有时候，我们会用gbdt来筛选特征，然后再上逻辑回归。</li>
</ol>
<h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><ol>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/ModifyRong/p/7739955.html">https://www.cnblogs.com/ModifyRong/p/7739955.html</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/sinat_33231573/article/details/99709837">https://blog.csdn.net/sinat_33231573/article/details/99709837</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/345566088">https://zhuanlan.zhihu.com/p/345566088</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/74874291">https://zhuanlan.zhihu.com/p/74874291</a></li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/05/10/ml/logistic_regression/" data-id="cl85d5h4a004si99o9gga5rlt" data-title="逻辑回归" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-ml/linear_regression" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/05/10/ml/linear_regression/" class="article-date">
  <time class="dt-published" datetime="2021-05-10T06:32:47.000Z" itemprop="datePublished">2021-05-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/05/10/ml/linear_regression/">线性回归</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>回归分析（regression analysis)是研究一组随机变量(y1 ，y2 ，…，yi)和另一组(x1，x2，…，xk)变量之间的关系的统计分析方法。<br>通常用于一个或多个自变量（也成解释变量、预测变量）来预测应变量（也称因变量、校变量或结果变量）的场景中。<br>譬如，体重和饮食，运动、睡眠之间有怎样的关系？施肥，浇水对树苗的成长关系？近期的广告投入提高了销售额么？日常生活中，淘宝相关产品，同类别歌曲的推荐中都用到了回归的原理。</p>
<h1 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h1><p>线性回归的前提假设之一是残差必须<code>服从独立正态分布</code>，<br>线性回归的损失函数mse就是：在某个(u,σ^2)下，使得服从正态分布的ε取得现有样本εi的概率最大从而推算出来的损失函数的表达式。</p>
<h1 id="假设"><a href="#假设" class="headerlink" title="假设"></a>假设</h1><ol>
<li>假设特征与标签之间满足线性关系</li>
<li>误差项（ε）之间应相互独立。（比如时间序列数据常常发生误差项不是相互独立的情况，比如今天的数据会收到昨天和前天的数据的影响）</li>
<li>自变量之间应相互独立</li>
<li>误差项（ε）应呈正态分布。</li>
</ol>
<h1 id="最小二乘法"><a href="#最小二乘法" class="headerlink" title="最小二乘法"></a>最小二乘法</h1><p>最小二乘法以<code>估计值与观测值的平方和</code>作为损失函数，在误差服从正态分布的前提下（这一点容易被忽视），与极大似然估计的思想在本质上是相同。<br>也就是说不是我们特意去选择mse作为线性回归的损失函数而是因为我们假设<code>误差服从正态分布</code>，使用<code>极大似然法（最大化误差项目为εi的样本总体出现的概率最大）来求解参数</code>，<br>进一步经过推导之后得到的mse的公式而已。</p>
<h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><ol>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/66519299">https://zhuanlan.zhihu.com/p/66519299</a></li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/05/10/ml/linear_regression/" data-id="cl85d5h49004pi99o9ckx9u45" data-title="线性回归" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-practice/kingsoft/0509" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/05/10/practice/kingsoft/0509/" class="article-date">
  <time class="dt-published" datetime="2021-05-10T03:20:32.000Z" itemprop="datePublished">2021-05-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E9%87%91%E5%B1%B1%E5%AE%9E%E4%B9%A0/">金山实习</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/05/10/practice/kingsoft/0509/">5月9日工作内容</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="工作内容"><a href="#工作内容" class="headerlink" title="工作内容"></a>工作内容</h1><ol>
<li>周留存， 用weekly那张表 ，拆分大盘、日本、泰国；</li>
<li>拆分预装和主动安装的，同时配合体量来看；</li>
<li>已知主动安装的留存率跟openfile强相关，捞取用户openfile的占比和频次变化；</li>
</ol>
<h1 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h1><ol>
<li>总体难度：比较简单，底层逻辑已经写好，只需要去对应的表里面去取数据就好。</li>
<li>需要注意：拼写，<code>unkonwn</code> != <code>unkonwn</code>。</li>
<li>Excel数据透视表的使用。</li>
<li>hive 中union all操作会讲数据的顺序打乱，因此需要在最后面加上<code>order</code>。</li>
</ol>
<h1 id="sql"><a href="#sql" class="headerlink" title="sql"></a>sql</h1><h2 id="总体周留存"><a href="#总体周留存" class="headerlink" title="总体周留存"></a>总体周留存</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> Japan <span class="keyword">as</span> (</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        week,</span><br><span class="line">        time_interval,</span><br><span class="line">        <span class="built_in">sum</span>(retention_devices) <span class="keyword">as</span> retention,</span><br><span class="line">        <span class="string">&#x27;Japan&#x27;</span> <span class="keyword">as</span> country</span><br><span class="line">    <span class="keyword">from</span> </span><br><span class="line">        `wps<span class="operator">-</span>data<span class="operator">-</span>analysis.wps_active.android_retentions_weekly`</span><br><span class="line">    <span class="keyword">where</span></span><br><span class="line">        week <span class="operator">&gt;=</span> <span class="string">&#x27;2021-03-01&#x27;</span> <span class="keyword">and</span> </span><br><span class="line">        country <span class="keyword">in</span> (<span class="string">&#x27;Japan&#x27;</span>) <span class="keyword">and</span> </span><br><span class="line">        time_interval <span class="keyword">in</span> (<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> week, time_interval</span><br><span class="line">    <span class="keyword">order</span> <span class="keyword">by</span> week</span><br><span class="line">),</span><br><span class="line">Thailand <span class="keyword">as</span> (</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        week,</span><br><span class="line">        time_interval,</span><br><span class="line">        <span class="built_in">sum</span>(retention_devices) <span class="keyword">as</span> retention,</span><br><span class="line">        <span class="string">&#x27;Thailand&#x27;</span> <span class="keyword">as</span> country</span><br><span class="line">    <span class="keyword">from</span> </span><br><span class="line">        `wps<span class="operator">-</span>data<span class="operator">-</span>analysis.wps_active.android_retentions_weekly`</span><br><span class="line">    <span class="keyword">where</span></span><br><span class="line">        week <span class="operator">&gt;=</span> <span class="string">&#x27;2021-03-01&#x27;</span> <span class="keyword">and</span> </span><br><span class="line">        country <span class="keyword">in</span> (<span class="string">&#x27;Thailand&#x27;</span>) <span class="keyword">and</span> </span><br><span class="line">        time_interval <span class="keyword">in</span> (<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> week, time_interval</span><br><span class="line">    <span class="keyword">order</span> <span class="keyword">by</span> week</span><br><span class="line">),</span><br><span class="line">Base <span class="keyword">as</span> (</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        week,</span><br><span class="line">        time_interval,</span><br><span class="line">        <span class="built_in">sum</span>(retention_devices) <span class="keyword">as</span> retention_devices,</span><br><span class="line">        <span class="string">&#x27;base&#x27;</span> <span class="keyword">as</span> country</span><br><span class="line">    <span class="keyword">from</span> </span><br><span class="line">        `wps<span class="operator">-</span>data<span class="operator">-</span>analysis.wps_active.android_retentions_weekly`</span><br><span class="line">    <span class="keyword">where</span></span><br><span class="line">        week <span class="operator">&gt;=</span> <span class="string">&#x27;2021-03-01&#x27;</span> <span class="keyword">and</span> </span><br><span class="line">        time_interval <span class="keyword">in</span> (<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> week, time_interval</span><br><span class="line">    <span class="keyword">order</span> <span class="keyword">by</span> week</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">    <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> </span><br><span class="line">    Base</span><br><span class="line"></span><br><span class="line"><span class="keyword">union</span> <span class="keyword">ALL</span></span><br><span class="line">(</span><br><span class="line">   <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> Japan </span><br><span class="line">   <span class="keyword">order</span> <span class="keyword">by</span> week</span><br><span class="line">)</span><br><span class="line"><span class="keyword">union</span> <span class="keyword">ALL</span></span><br><span class="line">(</span><br><span class="line">   <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> Thailand  </span><br><span class="line">   <span class="keyword">order</span> <span class="keyword">by</span> week</span><br><span class="line">)</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> country, week</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="区分预装非预装"><a href="#区分预装非预装" class="headerlink" title="区分预装非预装"></a>区分预装非预装</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"># 拆分大盘、日本、泰国</span><br><span class="line"># 拆分主动还是预装</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> Japan <span class="keyword">as</span> (</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        is_oem,</span><br><span class="line">        week,</span><br><span class="line">        time_interval,</span><br><span class="line">        <span class="built_in">sum</span>(retention_devices) <span class="keyword">as</span> retention,</span><br><span class="line">        <span class="string">&#x27;日本&#x27;</span> <span class="keyword">as</span> country,</span><br><span class="line">    <span class="keyword">from</span> (</span><br><span class="line">        <span class="keyword">select</span> </span><br><span class="line">            week,</span><br><span class="line">            time_interval,</span><br><span class="line">            retention_devices,</span><br><span class="line">            <span class="keyword">case</span> <span class="keyword">when</span> wps_channel_oem <span class="keyword">in</span> (<span class="string">&#x27;unknown&#x27;</span>) <span class="keyword">then</span> <span class="number">0</span> <span class="keyword">when</span> wps_channel_oem <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">then</span> <span class="number">0</span> <span class="keyword">else</span> <span class="number">1</span> <span class="keyword">end</span> <span class="keyword">as</span> is_oem</span><br><span class="line">        <span class="keyword">from</span> </span><br><span class="line">            `wps<span class="operator">-</span>data<span class="operator">-</span>analysis.wps_active.android_retentions_weekly`</span><br><span class="line">        <span class="keyword">where</span> </span><br><span class="line">            week <span class="operator">&gt;=</span> <span class="string">&#x27;2021-03-01&#x27;</span> <span class="keyword">and</span> </span><br><span class="line">            country <span class="keyword">in</span> (<span class="string">&#x27;Japan&#x27;</span>) <span class="keyword">and</span> </span><br><span class="line">            time_interval <span class="keyword">in</span> (<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">order</span> <span class="keyword">by</span> week</span><br><span class="line">    ) <span class="keyword">as</span> a</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> is_oem, week, time_interval</span><br><span class="line">    <span class="keyword">order</span> <span class="keyword">by</span> is_oem, week</span><br><span class="line">),</span><br><span class="line">Thailand <span class="keyword">as</span> (</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        is_oem,</span><br><span class="line">        week,</span><br><span class="line">        time_interval,</span><br><span class="line">        <span class="built_in">sum</span>(retention_devices) <span class="keyword">as</span> retention,</span><br><span class="line">        <span class="string">&#x27;泰国&#x27;</span> <span class="keyword">as</span> country,</span><br><span class="line">    <span class="keyword">from</span> (</span><br><span class="line">        <span class="keyword">select</span> </span><br><span class="line">            week,</span><br><span class="line">            time_interval,</span><br><span class="line">            retention_devices,</span><br><span class="line">            <span class="keyword">case</span> <span class="keyword">when</span> wps_channel_oem <span class="keyword">in</span> (<span class="string">&#x27;unknown&#x27;</span>) <span class="keyword">then</span> <span class="number">0</span> <span class="keyword">when</span> wps_channel_oem <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">then</span> <span class="number">0</span> <span class="keyword">else</span> <span class="number">1</span> <span class="keyword">end</span> <span class="keyword">as</span> is_oem</span><br><span class="line">        <span class="keyword">from</span> </span><br><span class="line">            `wps<span class="operator">-</span>data<span class="operator">-</span>analysis.wps_active.android_retentions_weekly`</span><br><span class="line">        <span class="keyword">where</span> </span><br><span class="line">            week <span class="operator">&gt;=</span> <span class="string">&#x27;2021-03-01&#x27;</span> <span class="keyword">and</span> </span><br><span class="line">            country <span class="keyword">in</span> (<span class="string">&#x27;Thailand&#x27;</span>) <span class="keyword">and</span> </span><br><span class="line">            time_interval <span class="keyword">in</span> (<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">order</span> <span class="keyword">by</span> week</span><br><span class="line">    ) <span class="keyword">as</span> a</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> is_oem, week, time_interval</span><br><span class="line">    <span class="keyword">order</span> <span class="keyword">by</span> is_oem, week    </span><br><span class="line">),</span><br><span class="line">Base <span class="keyword">as</span> (</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        is_oem,</span><br><span class="line">        week,</span><br><span class="line">        time_interval,</span><br><span class="line">        <span class="built_in">sum</span>(retention_devices) <span class="keyword">as</span> retention,</span><br><span class="line">        <span class="string">&#x27;大盘&#x27;</span> <span class="keyword">as</span> country,</span><br><span class="line">    <span class="keyword">from</span> (</span><br><span class="line">        <span class="keyword">select</span> </span><br><span class="line">            week,</span><br><span class="line">            time_interval,</span><br><span class="line">            retention_devices,</span><br><span class="line">            <span class="keyword">case</span> <span class="keyword">when</span> wps_channel_oem <span class="keyword">in</span> (<span class="string">&#x27;unkonwn&#x27;</span>) <span class="keyword">then</span> <span class="number">0</span> <span class="keyword">when</span> wps_channel_oem <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">then</span> <span class="number">0</span> <span class="keyword">else</span> <span class="number">1</span> <span class="keyword">end</span> <span class="keyword">as</span> is_oem</span><br><span class="line">        <span class="keyword">from</span> </span><br><span class="line">            `wps<span class="operator">-</span>data<span class="operator">-</span>analysis.wps_active.android_retentions_weekly`</span><br><span class="line">        <span class="keyword">where</span> </span><br><span class="line">            week <span class="operator">&gt;=</span> <span class="string">&#x27;2021-03-01&#x27;</span> <span class="keyword">and</span> </span><br><span class="line">            time_interval <span class="keyword">in</span> (<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">order</span> <span class="keyword">by</span> week</span><br><span class="line">    ) <span class="keyword">as</span> a</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> is_oem, week, time_interval</span><br><span class="line">    <span class="keyword">order</span> <span class="keyword">by</span> is_oem, week</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">    <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> </span><br><span class="line">    Base</span><br><span class="line"><span class="keyword">union</span> <span class="keyword">ALL</span></span><br><span class="line">    (</span><br><span class="line">    <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> Japan</span><br><span class="line">    )</span><br><span class="line"><span class="keyword">union</span> <span class="keyword">ALL</span></span><br><span class="line">    (</span><br><span class="line">    <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> Thailand  </span><br><span class="line">    )</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span></span><br><span class="line">    country, is_oem, week</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="捞取用户openfile的占比和频次变化"><a href="#捞取用户openfile的占比和频次变化" class="headerlink" title="捞取用户openfile的占比和频次变化"></a>捞取用户openfile的占比和频次变化</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>  </span><br><span class="line">    <span class="type">date</span>,</span><br><span class="line">    <span class="built_in">sum</span>(if_view)</span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">    `wps<span class="operator">-</span>data<span class="operator">-</span>analysis.wps_active.android_core_feature_view_edit` </span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">    <span class="type">date</span> <span class="operator">&gt;=</span> <span class="string">&#x27;2021-03-01&#x27;</span> <span class="keyword">and</span></span><br><span class="line">    (wps_channel_oem <span class="operator">=</span> <span class="string">&#x27;unknown&#x27;</span> <span class="keyword">or</span> wps_channel_oem <span class="keyword">is</span> <span class="keyword">null</span>)</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> </span><br><span class="line">    <span class="type">date</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="type">date</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/05/10/practice/kingsoft/0509/" data-id="cl85d5h6h00bai99o8b2genil" data-title="5月9日工作内容" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-sql/retention" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/05/10/sql/retention/" class="article-date">
  <time class="dt-published" datetime="2021-05-10T02:01:05.000Z" itemprop="datePublished">2021-05-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/SQL/">SQL</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/05/10/sql/retention/">计算各种留存</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="概念解析"><a href="#概念解析" class="headerlink" title="概念解析"></a>概念解析</h1><p>留存是以某日期为基准，如果该用户在该基准日期的后N天再次登录系统，则记录为一次N日留存。</p>
<p>留存包括：普通用户留存与新用户留存。新用户留存如<a href="/2021/05/10/sql/niuke-70/">牛客网第70题</a></p>
<h1 id="解题1-以日为单位计算留存"><a href="#解题1-以日为单位计算留存" class="headerlink" title="解题1-以日为单位计算留存"></a>解题1-以日为单位计算留存</h1><h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2><p><img src="https://pic2.zhimg.com/80/v2-17ef440668a922929e48cf784b5224b9_720w.jpg"><br>这是一个APP的用户活跃日期表。<br>有两个字段： user_id 当日活跃用户的ID，dates用户活跃的日期。<br>最终我们想要得到如下留存表：<br><img src="https://pic3.zhimg.com/80/v2-d93075ba8bcf738ba584781748ad20b6_720w.jpg"><br>dates1计算留存的基准日日期。<br>day0基准日当日的活跃用户数。</p>
<h2 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h2><ol>
<li>左连接自己</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="keyword">all</span> <span class="keyword">as</span> (</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        a.user_id,</span><br><span class="line">        a.dates <span class="keyword">as</span> d1,</span><br><span class="line">        b.dates <span class="keyword">as</span> d2</span><br><span class="line">    <span class="keyword">from</span></span><br><span class="line">        temp_user_act <span class="keyword">as</span> a,</span><br><span class="line">    <span class="keyword">left</span> <span class="keyword">join</span> </span><br><span class="line">        temp_user_act <span class="keyword">as</span> b</span><br><span class="line">    <span class="keyword">on</span> a.user_id <span class="operator">=</span> b.user_id</span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>找出右表日期大于等于左表日期的内容（排除基准日之前的数据）</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> filer_all <span class="keyword">as</span> (</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        <span class="operator">*</span></span><br><span class="line">    <span class="keyword">from</span></span><br><span class="line">        <span class="keyword">all</span></span><br><span class="line">    <span class="keyword">where</span></span><br><span class="line">        d2 <span class="operator">&gt;=</span> d1 <span class="comment">-- 这里需要注意，要等于</span></span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>计算以左表日期为基准日的当日用户数，第二日、第三日、第四日、第八日回访用户数</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> retention_num <span class="keyword">as</span> (</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        d1,</span><br><span class="line">        <span class="built_in">count</span>(<span class="keyword">distinct</span> <span class="keyword">case</span> <span class="keyword">when</span> d1 <span class="operator">=</span> d2 <span class="keyword">then</span> user_id <span class="keyword">else</span> <span class="keyword">null</span> <span class="keyword">end</span>) <span class="keyword">as</span> day0, <span class="comment">-- 一定要加上distinct，因为用户一天之内可能会登录很多次</span></span><br><span class="line">        <span class="built_in">count</span>(<span class="keyword">distinct</span> <span class="keyword">case</span> <span class="keyword">when</span> datediff(d2, d1) <span class="operator">=</span> <span class="number">1</span> <span class="keyword">then</span> user_id <span class="keyword">else</span> <span class="keyword">null</span> <span class="keyword">end</span>) <span class="keyword">as</span> day1 <span class="comment">-- 次日</span></span><br><span class="line">        <span class="comment">-- .....N日</span></span><br><span class="line">    <span class="keyword">from</span></span><br><span class="line">        filter_all</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> </span><br><span class="line">        d1</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>计算留存率<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    d1, </span><br><span class="line">    day0,</span><br><span class="line">    CONCAT( <span class="built_in">CAST</span>( ( day1 <span class="operator">/</span> day0 ) <span class="operator">*</span> <span class="number">100</span> <span class="keyword">as</span> <span class="type">DECIMAL</span>(<span class="number">18</span>,<span class="number">2</span>)) , <span class="string">&#x27;%&#x27;</span> ) <span class="string">&#x27;次日留存率&#x27;</span>,</span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">    retention_num</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> d1</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="优化写法"><a href="#优化写法" class="headerlink" title="优化写法"></a>优化写法</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">    a.login_date,</span><br><span class="line">    <span class="built_in">count</span>(<span class="keyword">distinct</span> a.user_id) <span class="keyword">as</span> dau, <span class="comment">-- daliy active user</span></span><br><span class="line">    <span class="built_in">count</span>(<span class="keyword">distinct</span> <span class="keyword">case</span> <span class="keyword">when</span> date_diff(<span class="string">&#x27;day&#x27;</span>, b.login_date, a.login_date) <span class="operator">=</span> <span class="number">1</span> <span class="keyword">then</span> a.user_id <span class="keyword">else</span> <span class="keyword">null</span> <span class="keyword">end</span>) <span class="operator">/</span></span><br><span class="line">        <span class="built_in">count</span>(<span class="keyword">distinct</span> a.user_id) <span class="keyword">as</span> day1_retention_rate</span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">    temp_user_act <span class="keyword">as</span> a</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> </span><br><span class="line">    temp_user_act <span class="keyword">as</span> b</span><br><span class="line"><span class="keyword">on</span> </span><br><span class="line">    a.user_id <span class="operator">=</span> b.user_id <span class="keyword">and</span> </span><br><span class="line">    a.login_date <span class="operator">&lt;=</span> b.login_date <span class="comment">-- 这里可以这样写</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> </span><br><span class="line">    a.login_date</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span></span><br><span class="line">    login_date</span><br></pre></td></tr></table></figure>

<h1 id="要点"><a href="#要点" class="headerlink" title="要点"></a>要点</h1><ol>
<li><p>自连接</p>
<ul>
<li>user_id相同</li>
<li>日期比较</li>
</ul>
</li>
<li><p>distinct<br>一个用户可能在同一天登录多个系统，需要去去重</p>
</li>
</ol>
<h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><ol>
<li>留存的概念. <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/49050001">https://zhuanlan.zhihu.com/p/49050001</a></li>
<li>计算日留存. <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/359336858">https://zhuanlan.zhihu.com/p/359336858</a></li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/05/10/sql/retention/" data-id="cl85d5h60009pi99o8z2k473e" data-title="计算各种留存" class="article-share-link">Teilen</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SQL/" rel="tag">SQL</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/14/">&laquo; zurück</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><a class="page-number" href="/page/14/">14</a><span class="page-number current">15</span><a class="page-number" href="/page/16/">16</a><a class="page-number" href="/page/17/">17</a><a class="extend next" rel="next" href="/page/16/">weiter &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Kategorien</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CV/">-CV</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Django/">Django</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Leetcode/">Leetcode</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/NLP/">NLP</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/SQL/">SQL</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/django/">django</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/leetcode/">leetcode</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/leetcode/sql/">sql</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%B8%9A%E5%8A%A1/">业务</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%B8%9A%E5%8A%A1%E6%8C%87%E6%A0%87/">业务指标</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%B8%AD%E4%BF%A1%E8%AF%81%E5%88%B8/">中信证券</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%85%B6%E4%BB%96/">其他</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%85%B6%E4%BB%96/Django/">Django</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/Flume/">Flume</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E9%9B%86/">数据集</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%AF%95%E4%B8%9A%E8%AE%BA%E6%96%87/">毕业论文</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/">毕业设计</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%88%AC%E8%99%AB/">爬虫</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%A7%8B%E6%8B%9B/">秋招</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%A7%8B%E6%8B%9B/%E9%9D%A2%E8%AF%95/">面试</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AC%94%E8%AF%95/">笔试</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BB%9F%E8%AE%A1%E5%AD%A6/">统计学</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AE%BA%E6%96%87/">论文</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%87%91%E5%B1%B1%E5%AE%9E%E4%B9%A0/">金山实习</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%93%B6%E8%81%94%E5%AE%9E%E4%B9%A0/">银联实习</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%9D%A2%E8%AF%95/">面试</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/leetcode/" rel="tag">-leetcode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CV/" rel="tag">CV</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Django/" rel="tag">Django</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Flume/" rel="tag">Flume</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hbase/" rel="tag">Hbase</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NLP/" rel="tag">NLP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL/" rel="tag">SQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/django/" rel="tag">django</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/leetcode/" rel="tag">leetcode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sql/" rel="tag">sql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%9A%E5%8A%A1/" rel="tag">业务</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%AD%E4%BF%A1%E8%AF%81%E5%88%B8/" rel="tag">中信证券</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%85%B6%E4%BB%96/" rel="tag">其他</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/" rel="tag">大数据</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%9E%E4%B9%A0/" rel="tag">实习</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B7%A5%E4%BD%9C/" rel="tag">工作</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="tag">数据结构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E9%9B%86/" rel="tag">数据集</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E9%A2%84%E6%B5%8B/" rel="tag">时间序列预测</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" rel="tag">机器学习</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%AF%95%E4%B8%9A%E8%AE%BA%E6%96%87/" rel="tag">毕业论文</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/" rel="tag">毕业设计</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%88%AC%E8%99%AB/" rel="tag">爬虫</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%A7%8B%E6%8B%9B/" rel="tag">秋招</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AC%94%E8%AF%95/" rel="tag">笔试</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BB%9F%E8%AE%A1%E5%AD%A6/" rel="tag">统计学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BA%E6%96%87/" rel="tag">论文</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%87%91%E5%B1%B1%E5%AE%9E%E4%B9%A0/" rel="tag">金山实习</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%93%B6%E8%81%94%E5%AE%9E%E4%B9%A0/" rel="tag">银联实习</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%A2%E8%AF%95/" rel="tag">面试</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/leetcode/" style="font-size: 10px;">-leetcode</a> <a href="/tags/CV/" style="font-size: 10px;">CV</a> <a href="/tags/Django/" style="font-size: 13.33px;">Django</a> <a href="/tags/Flume/" style="font-size: 10px;">Flume</a> <a href="/tags/Hbase/" style="font-size: 10px;">Hbase</a> <a href="/tags/NLP/" style="font-size: 10px;">NLP</a> <a href="/tags/SQL/" style="font-size: 18.89px;">SQL</a> <a href="/tags/django/" style="font-size: 10px;">django</a> <a href="/tags/leetcode/" style="font-size: 15.56px;">leetcode</a> <a href="/tags/sql/" style="font-size: 10px;">sql</a> <a href="/tags/%E4%B8%9A%E5%8A%A1/" style="font-size: 13.33px;">业务</a> <a href="/tags/%E4%B8%AD%E4%BF%A1%E8%AF%81%E5%88%B8/" style="font-size: 11.11px;">中信证券</a> <a href="/tags/%E5%85%B6%E4%BB%96/" style="font-size: 20px;">其他</a> <a href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/" style="font-size: 13.33px;">大数据</a> <a href="/tags/%E5%AE%9E%E4%B9%A0/" style="font-size: 16.67px;">实习</a> <a href="/tags/%E5%B7%A5%E4%BD%9C/" style="font-size: 11.11px;">工作</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 10px;">数据结构</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E9%9B%86/" style="font-size: 10px;">数据集</a> <a href="/tags/%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E9%A2%84%E6%B5%8B/" style="font-size: 10px;">时间序列预测</a> <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" style="font-size: 12.22px;">机器学习</a> <a href="/tags/%E6%AF%95%E4%B8%9A%E8%AE%BA%E6%96%87/" style="font-size: 14.44px;">毕业论文</a> <a href="/tags/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/" style="font-size: 10px;">毕业设计</a> <a href="/tags/%E7%88%AC%E8%99%AB/" style="font-size: 12.22px;">爬虫</a> <a href="/tags/%E7%A7%8B%E6%8B%9B/" style="font-size: 13.33px;">秋招</a> <a href="/tags/%E7%AC%94%E8%AF%95/" style="font-size: 12.22px;">笔试</a> <a href="/tags/%E7%BB%9F%E8%AE%A1%E5%AD%A6/" style="font-size: 12.22px;">统计学</a> <a href="/tags/%E8%AE%BA%E6%96%87/" style="font-size: 11.11px;">论文</a> <a href="/tags/%E9%87%91%E5%B1%B1%E5%AE%9E%E4%B9%A0/" style="font-size: 13.33px;">金山实习</a> <a href="/tags/%E9%93%B6%E8%81%94%E5%AE%9E%E4%B9%A0/" style="font-size: 10px;">银联实习</a> <a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size: 17.78px;">面试</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archiv</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">May 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">May 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">March 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">letzter Beitrag</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/05/14/other/time_series_pred/">时间序列预测</a>
          </li>
        
          <li>
            <a href="/2023/05/01/other/customer_analysis_in_python/">用户价值分析</a>
          </li>
        
          <li>
            <a href="/2022/06/15/other/PEP8/">PEP-8: Python代码规范</a>
          </li>
        
          <li>
            <a href="/2022/05/29/other/fanqie/">番茄工作法</a>
          </li>
        
          <li>
            <a href="/2022/05/20/citics/neo4j_query_optimize/">neo4j查询调优</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>