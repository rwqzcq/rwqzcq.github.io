<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>rwqccnuimd的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="rwqccnuimd的博客">
<meta property="og:url" content="http://example.com/page/7/index.html">
<meta property="og:site_name" content="rwqccnuimd的博客">
<meta property="og:locale">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="rwqccnuimd的博客" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">rwqccnuimd的博客</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Suche"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Suche"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-mianshi/pingan" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/09/14/mianshi/pingan/" class="article-date">
  <time class="dt-published" datetime="2021-09-14T06:20:49.000Z" itemprop="datePublished">2021-09-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E9%9D%A2%E8%AF%95/">面试</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/09/14/mianshi/pingan/">平安</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="平安租赁"><a href="#平安租赁" class="headerlink" title="平安租赁"></a>平安租赁</h1><h2 id="一面"><a href="#一面" class="headerlink" title="一面"></a>一面</h2><ul>
<li>三个词形容一下自己</li>
<li>导师眼中的你</li>
<li>同学眼中你的</li>
<li>自己面对的最大的困难</li>
<li>项目</li>
<li>自己未来3到5年的职业规划</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/09/14/mianshi/pingan/" data-id="cl85d5h3s003bi99oex2p9ohc" data-title="平安" class="article-share-link">Teilen</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%9D%A2%E8%AF%95/" rel="tag">面试</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-mianshi/bilibili" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/09/14/mianshi/bilibili/" class="article-date">
  <time class="dt-published" datetime="2021-09-14T06:20:05.000Z" itemprop="datePublished">2021-09-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E9%9D%A2%E8%AF%95/">面试</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/09/14/mianshi/bilibili/">B站</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="一面"><a href="#一面" class="headerlink" title="一面"></a>一面</h1><ul>
<li><p>你是B站数据分析师，你认为有哪一些指标可以分析</p>
<ul>
<li>八股文</li>
<li>付费的</li>
<li>内容的</li>
<li>UP主的</li>
<li>内容供给的</li>
</ul>
</li>
<li><p>DAU下降怎么分析</p>
</li>
<li><p>8股文</p>
</li>
<li><p>不用内容分区的情况</p>
</li>
<li><p>介绍自己的金山项目</p>
</li>
<li><p>介绍自己的职业规划</p>
</li>
<li><p>面向业务</p>
</li>
<li><p>B站现在做得是数据中台</p>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/09/14/mianshi/bilibili/" data-id="cl85d5h3m002ti99o7pqa8k84" data-title="B站" class="article-share-link">Teilen</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%9D%A2%E8%AF%95/" rel="tag">面试</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-biyelunwen/2_jinrong" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/09/12/biyelunwen/2_jinrong/" class="article-date">
  <time class="dt-published" datetime="2021-09-12T07:22:24.000Z" itemprop="datePublished">2021-09-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%AF%95%E4%B8%9A%E8%AE%BA%E6%96%87/">毕业论文</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/09/12/biyelunwen/2_jinrong/">金融知识图谱</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="知识图谱在金融领域的应用"><a href="#知识图谱在金融领域的应用" class="headerlink" title="知识图谱在金融领域的应用"></a>知识图谱在金融领域的应用</h1><h2 id="金融反欺诈"><a href="#金融反欺诈" class="headerlink" title="金融反欺诈"></a>金融反欺诈</h2><p>反欺诈是风控中非常重要的一道环节，也是知识图谱适合应用的场景。反欺诈的核心是人，这就要求把与<code>借款人相关的数据源打通</code>，然后抽取该借款人的<code>特征标签</code>，从而将相关的信息整合成结构化的知识图谱。其中，不仅可以处理记录借款人的基本信息，还可以把借款人日常生活中的<code>消费记录</code>、行为记录、关系信息、网上浏览记录等整合到知识图谱里。在此基础上，对该借款人的借贷风险进行分析和评估。</p>
<p>反欺诈的应用不仅体现在贷前阶段，还可以应用在贷中阶段，通过<code>构建已知的主要欺诈要素(如手机、设备、账号和地域等)的关系图谱</code>，全方位了解借款人风险数据的统计分析，对<code>潜在的欺诈行</code>为作出及时的反应。当然，这要求能够获得借款人全方位的各种类型的信息，并且利用机器学习和自然语言处理技术从数据中提取出符合图谱规格的数据。</p>
<p>相比虚假身份的识别，组团欺诈的发现难度更大。一般来说，团体欺诈往往隐藏在非常复杂的关系网络里，很难识别。只有把其中<code>隐含的关系网络</code>梳理清楚，才有可能去分析出其中潜在的风险。知识图谱，因为天生用来描述关系网络，因而具备了分析组团欺诈的便捷手段。</p>
<blockquote>
<p>梳理隐含关系</p>
</blockquote>
<h2 id="风险预测"><a href="#风险预测" class="headerlink" title="风险预测"></a>风险预测</h2><p>基于多维度的数据，从而建立起<code>客户</code>、<code>企业</code>和<code>行业间</code>的知识图谱，从<code>行业关联</code>的角度预测行业或企业面临的风险。例如，通过对行业进行细分，根据<code>贷款信息</code>、行业信息建立行业间的关系模型；通过机器学习，可发现各个<code>行业间的关联度</code>，如果某一行业发生了行业风险或高风险事件，根据关联关系可以及时预测有潜在风险的其他行业。从而可以帮助金融机构做出预判，尽早地规避风险。</p>
<p>通过知识图谱，也可以将<code>行业和企业之间数据</code>进行连接，借助对行业的潜在风险的预测，能够及时发现与该行业风险或系统性风险相关联的<code>企业客户</code>。例如，某地区某行业连续出现了多笔逾期贷款，通过对行业和客户的知识图谱进行分析，可以及时发现该地区相关行业存在潜在风险的客户。</p>
<blockquote>
<p>企业的风险预测</p>
</blockquote>
<h2 id="精准营销"><a href="#精准营销" class="headerlink" title="精准营销"></a>精准营销</h2><p>优秀的企业可以比竞争对手更有效地挖掘潜在客户，其中起关键作用的是<code>分析用户</code>和<code>理解用户</code>。知识图谱综合了多个数据源，挖掘出实体之间的关系，从而对用户的行为有更好的理解，能更好、更深入地理解用户的需求，挖掘已有客户的<code>潜在需求</code>，针对性地推送相关产品，更好地为客户提供营销服务。比如，市场经理可以用知识图谱来分析<code>用户之间的关系</code>，发现<code>共同的喜好</code>，从而有针对性的对某一类人群制定<code>营销策略</code>；如果对知识图谱扩展（如增加车辆信息、个人爱好、行为等），可以更加精准地分析客户行为，进行精准推送。</p>
<p>同样，挖掘潜在客户也是金融行业重点关注的工作。如果能够通过全方位的数据，精准、迅速地找到相关业务的潜在客户，对于提升银行的业务会有很大的帮助。基于银行客户建立社交网络知识图谱，根据各种<code>社交行为</code>（如交往方式、频次等）发现图谱的关系模型，对客户社交网中的相关主体（如亲属、朋友、同事、同学、陌生人等）进行挖掘，评估<code>关系紧密度</code>。</p>
<h2 id="智能检索"><a href="#智能检索" class="headerlink" title="智能检索"></a>智能检索</h2><p>基于知识图谱，我们也可以提供<code>智能搜索</code>和<code>数据可视化服</code>务。智能搜索的功能指的是，知识图谱能够在语义上<code>扩展用户的搜索关键词</code>，从而返回更丰富、更全面的信息。比如，搜索某个人的身份证号，可以返回与这个人相关的所有<code>历史借款记录</code>、<code>联系人关系</code>和其他相关的标签（如黑名单等）。这些结果可以用图形网络的方式展示，从而把复杂的信息以直观明了的图像呈现出来，让使用者对隐藏信息的来龙去脉一目了然。</p>
<h2 id="反欺诈"><a href="#反欺诈" class="headerlink" title="反欺诈"></a>反欺诈</h2><p>在反洗钱领域，我们同样可以帮助监管部门进行有效的监控，通过对关系账号进行逐级挖掘，可以找到隐藏在背后的洗钱账号。相比单独账号、关系的识别，对反洗钱团伙的挖掘难度更大，这种组织往往隐藏在在非常复杂的关系网络中，很难被发现。我们只有把其中隐含的关系网络梳理清楚，同时从时间、空间多维角度进行分析，才能识别潜在的风险，发现隐藏的反洗钱团伙。</p>
<h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><ol>
<li>知识图谱正在改变金融？深度解剖知识图谱的四大应用. <a target="_blank" rel="noopener" href="https://www.jiemian.com/article/1636099.html">https://www.jiemian.com/article/1636099.html</a></li>
<li>“知识图谱”如何应用在金融行业？ <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/27690902">https://zhuanlan.zhihu.com/p/27690902</a></li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/09/12/biyelunwen/2_jinrong/" data-id="cl85d5h2v000ti99o51o833of" data-title="金融知识图谱" class="article-share-link">Teilen</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%AF%95%E4%B8%9A%E8%AE%BA%E6%96%87/" rel="tag">毕业论文</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-ml/collection" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/09/11/ml/collection/" class="article-date">
  <time class="dt-published" datetime="2021-09-11T08:57:01.000Z" itemprop="datePublished">2021-09-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/09/11/ml/collection/">机器学习算法梳理</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="常见算法"><a href="#常见算法" class="headerlink" title="常见算法"></a>常见算法</h1><p><a href="%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95.pdf">链接</a></p>
<h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><p><a href="%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%85%B6%E4%BB%96.pdf">链接</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/09/11/ml/collection/" data-id="cl85d5h47004ji99o4onq266p" data-title="机器学习算法梳理" class="article-share-link">Teilen</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" rel="tag">机器学习</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-leetcode/1225" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/09/11/leetcode/1225/" class="article-date">
  <time class="dt-published" datetime="2021-09-11T02:28:48.000Z" itemprop="datePublished">2021-09-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/leetcode/">leetcode</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/09/11/leetcode/1225/">报告系统状态的连续日期</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">Table: Failed</span><br><span class="line"></span><br><span class="line">+--------------+---------+</span><br><span class="line">| Column Name  | Type    |</span><br><span class="line">+--------------+---------+</span><br><span class="line">| fail_date    | date    |</span><br><span class="line">+--------------+---------+</span><br><span class="line">该表主键为 fail_date。</span><br><span class="line">该表包含失败任务的天数.</span><br><span class="line">Table: Succeeded</span><br><span class="line"></span><br><span class="line">+--------------+---------+</span><br><span class="line">| Column Name  | Type    |</span><br><span class="line">+--------------+---------+</span><br><span class="line">| success_date | date    |</span><br><span class="line">+--------------+---------+</span><br><span class="line">该表主键为 success_date。</span><br><span class="line">该表包含成功任务的天数.</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">系统 每天 运行一个任务。每个任务都独立于先前的任务。任务的状态可以是失败或是成功。</span><br><span class="line"></span><br><span class="line">编写一个 SQL 查询 2019-01-01 到 2019-12-31 期间任务连续同状态 period_state 的起止日期（start_date 和 end_date）。即如果任务失败了，就是失败状态的起止日期，如果任务成功了，就是成功状态的起止日期。</span><br><span class="line"></span><br><span class="line">最后结果按照起始日期 start_date 排序</span><br><span class="line"></span><br><span class="line">查询结果样例如下所示:</span><br><span class="line"></span><br><span class="line">Failed table:</span><br><span class="line">+-------------------+</span><br><span class="line">| fail_date         |</span><br><span class="line">+-------------------+</span><br><span class="line">| 2018-12-28        |</span><br><span class="line">| 2018-12-29        |</span><br><span class="line">| 2019-01-04        |</span><br><span class="line">| 2019-01-05        |</span><br><span class="line">+-------------------+</span><br><span class="line"></span><br><span class="line">Succeeded table:</span><br><span class="line">+-------------------+</span><br><span class="line">| success_date      |</span><br><span class="line">+-------------------+</span><br><span class="line">| 2018-12-30        |</span><br><span class="line">| 2018-12-31        |</span><br><span class="line">| 2019-01-01        |</span><br><span class="line">| 2019-01-02        |</span><br><span class="line">| 2019-01-03        |</span><br><span class="line">| 2019-01-06        |</span><br><span class="line">+-------------------+</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Result table:</span><br><span class="line">+--------------+--------------+--------------+</span><br><span class="line">| period_state | start_date   | end_date     |</span><br><span class="line">+--------------+--------------+--------------+</span><br><span class="line">| succeeded    | 2019-01-01   | 2019-01-03   |</span><br><span class="line">| failed       | 2019-01-04   | 2019-01-05   |</span><br><span class="line">| succeeded    | 2019-01-06   | 2019-01-06   |</span><br><span class="line">+--------------+--------------+--------------+</span><br><span class="line"></span><br><span class="line">结果忽略了 2018 年的记录，因为我们只关心从 2019-01-01 到 2019-12-31 的记录</span><br><span class="line">从 2019-01-01 到 2019-01-03 所有任务成功，系统状态为 &quot;succeeded&quot;。</span><br><span class="line">从 2019-01-04 到 2019-01-05 所有任务失败，系统状态为 &quot;failed&quot;。</span><br><span class="line">从 2019-01-06 到 2019-01-06 所有任务成功，系统状态为 &quot;succeeded&quot;。</span><br><span class="line"></span><br><span class="line">来源：力扣（LeetCode）</span><br><span class="line">链接：https://leetcode-cn.com/problems/report-contiguous-dates</span><br><span class="line">著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</span><br></pre></td></tr></table></figure>

<h1 id="解题"><a href="#解题" class="headerlink" title="解题"></a>解题</h1><blockquote>
<p>典型的连续区间问题，但是需要注意的是它把<code>连续1天</code>也包括在内。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">with</span> base <span class="keyword">as</span> (</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        <span class="operator">*</span></span><br><span class="line">    <span class="keyword">from</span> (</span><br><span class="line">        <span class="keyword">select</span></span><br><span class="line">            <span class="string">&#x27;succeeded&#x27;</span> <span class="keyword">as</span> period_state,</span><br><span class="line">            success_date <span class="keyword">as</span> <span class="type">date</span></span><br><span class="line">        <span class="keyword">from</span></span><br><span class="line">            Succeeded</span><br><span class="line">        <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">        <span class="keyword">select</span></span><br><span class="line">            <span class="string">&#x27;failed&#x27;</span> <span class="keyword">as</span> period_state,</span><br><span class="line">            fail_date <span class="keyword">as</span> <span class="type">date</span></span><br><span class="line">        <span class="keyword">from</span></span><br><span class="line">            Failed</span><br><span class="line">    ) <span class="keyword">as</span> a</span><br><span class="line">    <span class="keyword">where</span></span><br><span class="line">        <span class="type">date</span> <span class="keyword">between</span> <span class="string">&#x27;2019-01-01&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;2019-12-31&#x27;</span></span><br><span class="line"></span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">    period_state,</span><br><span class="line">    <span class="built_in">min</span>(<span class="type">date</span>) <span class="keyword">as</span> start_date,</span><br><span class="line">    <span class="built_in">max</span>(<span class="type">date</span>) <span class="keyword">as</span> end_date</span><br><span class="line"><span class="keyword">from</span> (</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        <span class="operator">*</span>,</span><br><span class="line">        <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> period_state, next_date) <span class="keyword">as</span> num <span class="comment">-- 分组统计</span></span><br><span class="line">    <span class="keyword">from</span> (</span><br><span class="line">        <span class="keyword">select</span></span><br><span class="line">            <span class="operator">*</span>,</span><br><span class="line">            date_sub(<span class="type">date</span>, <span class="type">interval</span> ranking <span class="keyword">day</span>) <span class="keyword">as</span> next_date <span class="comment">-- 计算间隔后的日期</span></span><br><span class="line">        <span class="keyword">from</span> (</span><br><span class="line">            <span class="keyword">select</span></span><br><span class="line">                <span class="operator">*</span>,</span><br><span class="line">                <span class="built_in">row_number</span>() <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> period_state <span class="keyword">order</span> <span class="keyword">by</span> <span class="type">date</span>) <span class="keyword">as</span> ranking <span class="comment">-- 排序</span></span><br><span class="line">            <span class="keyword">from</span></span><br><span class="line">                base</span><br><span class="line">        ) <span class="keyword">as</span> a</span><br><span class="line">    ) <span class="keyword">as</span> a</span><br><span class="line">) <span class="keyword">as</span> a</span><br><span class="line"><span class="keyword">where</span></span><br><span class="line">    num <span class="operator">&gt;=</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span></span><br><span class="line">    period_state,</span><br><span class="line">    next_date, <span class="comment">-- 这里需要注意，他是保证连续1天的关键</span></span><br><span class="line">    num  </span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span></span><br><span class="line">    start_date</span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/09/11/leetcode/1225/" data-id="cl85d5h37001qi99ofd1h2iw6" data-title="报告系统状态的连续日期" class="article-share-link">Teilen</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SQL/" rel="tag">SQL</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/leetcode/" rel="tag">leetcode</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-biyelunwen/1_kaiti" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/09/07/biyelunwen/1_kaiti/" class="article-date">
  <time class="dt-published" datetime="2021-09-07T13:50:53.000Z" itemprop="datePublished">2021-09-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%AF%95%E4%B8%9A%E8%AE%BA%E6%96%87/">毕业论文</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/09/07/biyelunwen/1_kaiti/">开题报告</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="论文题目"><a href="#论文题目" class="headerlink" title="论文题目"></a>论文题目</h1><p>基于事件知识图谱的事件脉络梳理与应用研究。</p>
<h1 id="论文的研究意义、国内外研究现状分析"><a href="#论文的研究意义、国内外研究现状分析" class="headerlink" title="论文的研究意义、国内外研究现状分析"></a>论文的研究意义、国内外研究现状分析</h1><h2 id="研究意义"><a href="#研究意义" class="headerlink" title="研究意义"></a>研究意义</h2><p>不同于以名词为核心的知识图谱，以动词为核心的事件图谱以动词为核心，能够有效刻画事物的运动变化，对动态的客观世界进行建模。知识图谱内含有实体的属性以及属性之间的关系，但当实体属性或者关系更新时，知识图谱只保留其最新的状态，而事件图谱则可以对某一个实体的属性或关系的变化过程进行建模。<br>以将这些事件与变化的进行一一对应。</p>
<h2 id="国内外研究现状"><a href="#国内外研究现状" class="headerlink" title="国内外研究现状"></a>国内外研究现状</h2><p>国内：<br>    - 事件没有严格定义，仅以句子的形式进行展示，聚焦于舆情领域，应用场景有待进一步扩展<br>    - 语义层次过高，在一般描述人类发展的客观规律外还应该有更加完备语义信息的知识</p>
<p>国外：<br>    - 聚焦于事件抽取、关系抽取等子任务，事件类型都是预先定义好的</p>
<h1 id="研究目标、研究内容和拟解决的关键问题"><a href="#研究目标、研究内容和拟解决的关键问题" class="headerlink" title="研究目标、研究内容和拟解决的关键问题"></a>研究目标、研究内容和拟解决的关键问题</h1><h2 id="研究目标"><a href="#研究目标" class="headerlink" title="研究目标"></a>研究目标</h2><h3 id="梳理现有的研究"><a href="#梳理现有的研究" class="headerlink" title="梳理现有的研究"></a>梳理现有的研究</h3><h3 id="构建图谱"><a href="#构建图谱" class="headerlink" title="构建图谱"></a>构建图谱</h3><h3 id="探索应用场景"><a href="#探索应用场景" class="headerlink" title="探索应用场景"></a>探索应用场景</h3><h2 id="研究内容"><a href="#研究内容" class="headerlink" title="研究内容"></a>研究内容</h2><p>本研究以“新冠疫情”这一影响人类文明进程的主题作为研究对象，通过挖掘自疫情爆发以来各国在疫情防控中所产生的一系列行为，挖掘这些行为的主体、客体的属性以及之间的关系构造事件知识图谱，从而梳理出不同国家在应对新冠疫情中的发展脉络，以确诊病例、治愈病例、死亡比例作为评价疫情防控表现的客观标准。<br>通过构建事件知识图谱，能够看到事件之间的相互关联关系，这对于完善疫情防控方案、针对不同部门开展政策指定均有一定价值。</p>
<h2 id="解决的关键问题"><a href="#解决的关键问题" class="headerlink" title="解决的关键问题"></a>解决的关键问题</h2><h3 id="事件表示"><a href="#事件表示" class="headerlink" title="事件表示"></a>事件表示</h3><h3 id="事件抽取"><a href="#事件抽取" class="headerlink" title="事件抽取"></a>事件抽取</h3><h3 id="关系抽取"><a href="#关系抽取" class="headerlink" title="关系抽取"></a>关系抽取</h3><h3 id="事件泛化"><a href="#事件泛化" class="headerlink" title="事件泛化"></a>事件泛化</h3><h3 id="图谱应用"><a href="#图谱应用" class="headerlink" title="图谱应用"></a>图谱应用</h3>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/09/07/biyelunwen/1_kaiti/" data-id="cl85d5h2t000mi99o2xaqelqo" data-title="开题报告" class="article-share-link">Teilen</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%AF%95%E4%B8%9A%E8%AE%BA%E6%96%87/" rel="tag">毕业论文</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-biyelunwen/0_baidu" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/09/07/biyelunwen/0_baidu/" class="article-date">
  <time class="dt-published" datetime="2021-09-07T13:30:14.000Z" itemprop="datePublished">2021-09-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%AF%95%E4%B8%9A%E8%AE%BA%E6%96%87/">毕业论文</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/09/07/biyelunwen/0_baidu/">百度事件图谱研究总结</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>事件也是一种知识，一种比较复杂的知识。事件知识的复杂性在于事件并不会对应到现实世界中的某一个具体的实体，它是一系列实体，以不同的角色在一段时间内参与活动的一个抽象。</p>
<p>为什么要做事件图谱？有两个方面原因：</p>
<p>第一方面，<code>事件其实更符合人类对客观世界的理解</code>。例如，以桃园三结义这幅图为例。在没有知识或弱知识的时候，我们可以知道这幅图里有三个人，有酒和树。在有实体知识的时候，我们可以知道这三个人的姓名是刘备、关羽和张飞，树是桃树。直到拥有事件知识的时候，我们才可以知道具体时间在东汉末年，刘备、关羽和张飞三个人在桃园做了结义这一个事情。我们可以看到，只有到事件这个层次上，才能说真正对这幅画有一个比较完整的把握。</p>
<p>另一方面，事件图谱可以<code>对动态的客观世界进行建模</code>。实体图谱会记录了实体的属性和关系，当实体的属性或关系更新时，图谱只会保留它最新的状态。但通过事件图谱，我们能够对属性或关系的整个变化过程进行建模，并且可以将这些事件与变化的进行一一对应。</p>
<p>我们目前正处在一个<code>信息爆炸</code>的时代，无论是个人消费者看新闻，还是专业从业者跟进行业事件消息，我们都不可避免地受到<code>信息过载</code>的影响。一方面存在太多无意义的信息分散了我们的注意力，另一方面当我们关注某个事件时，却又无法快速、全面地获得信息。怎么样去智能化地对事件进行处理，帮助我们<code>更高效的获取和处理事件信息</code>呢？关键就是事件图谱。智能地对事件进行处理的三个方面：事件理解、资源组织、分析决策都需要事件图谱。</p>
<ul>
<li><p>事件理解：以“山西饭店倒塌事件”为例，如果没有事件图谱，我们只能得到与这个单独的事件相关的内容。而通过事件图谱，我们还能得到它的一些后续事件，如“国务院督办”等。基于这样一种事件级别的理解，我们就可以把原来只是聚焦于一个单一事件的内容升级为对事件的上下文、前因后果都能联系起来的一种事件脉络的呈现，从而大大提升用户获取事件信息的效率。</p>
</li>
<li><p>资源组织：在没有事件图谱的情况下，事件的信息载体通常是新闻资讯，这些新闻资讯常常存在重复、角度不一、来源混杂的情况。在事件图谱的基础上，我们可以将各种资源，包括图片、视频、资讯、观点等，围绕事件进行组织，从而帮助用户更高效更全面地获取事件信息。</p>
</li>
<li><p>分析决策：在没有事件图谱辅助的情况下，决策常常是决策者结合现实情况和主观经验做出的，在多数情况下，我们很难判断决策者是否已经考虑了所有的现实情况，并且对未来可能发生的不同的方向进行了足够的考虑。而基于事件图谱，我们能够让决策者清晰地了解一个事件可能的原因和结果，从而使决策者能够做出更加全面及有根据的考虑。</p>
</li>
</ul>
<p>当前百度的事件图谱构建方案如下：</p>
<ul>
<li>首先，进行<code>事件检测</code>。</li>
<li>其次，在事件检测的基础上归纳出<code>事件表示体系</code>。</li>
<li>最后，在事件表示体系的基础上进行<code>事件抽取</code>和<code>关系抽取</code>。</li>
</ul>
<h1 id="事件检测"><a href="#事件检测" class="headerlink" title="事件检测"></a>事件检测</h1><p>第一部分，我们会对信息流中的资讯进行<code>事件识别</code>，将非事件的内容排除在外。<br>第二部分，我们会对出现在资讯中的<code>事件片段</code>以事件名的形式抽取出来。<br>第三部分，我们会对事件进行<code>归一</code>。然后再将对应的资讯作为这个事件的资源关联起来。</p>
<h1 id="事件表示"><a href="#事件表示" class="headerlink" title="事件表示"></a>事件表示</h1><p>我们必须从<code>正文中去挖掘事件类型的属性</code>。比如，“破产”这个事件类型。从类型名可以知道该事件可能会有一个“破产人”属性，但是“债权人”这个属性就必须从该类型相关的正文中才能找到。目前的解决方案是<code>开放挖掘+人工校验</code>。具体来说分成下面几个部分。<br>首先是<code>开放类型挖掘</code>，基于事件检测得到的事件库、日志等数据，我们挖掘出事件对应的类型并进行<code>层次构建</code>。在得到这样一个事件类型体系之后，我们会针对事件类型进行相关资讯<code>召回</code>，再进行每个类型的<code>角色挖掘</code>。最后再进行<code>人工校验</code>。通过这种方式，我们在几十个领域中得到几千个事件类型，以及一万多的事件角色。</p>
<h1 id="事件抽取"><a href="#事件抽取" class="headerlink" title="事件抽取"></a>事件抽取</h1><p>针对不同的关注点和文本形态，我们均挖掘出<code>核心的事件句</code>。然后，基于这些事件句，针对不同场景使用不同的抽取技术进行抽取。目前我们已具备的抽取技术包括<code>通用属性抽取</code>、<code>语义角色抽取</code>和<code>自定义的论元抽取</code>。</p>
<h2 id="通用属性抽取"><a href="#通用属性抽取" class="headerlink" title="通用属性抽取"></a>通用属性抽取</h2><p>通用属性抽取的目的是抽取<code>触发词</code>、<code>时间</code>，<code>地点</code>、<code>参与者</code>等通用的事件角色。由于技术是比较通用的，我们采取的是一个多属性联合抽取的模型。这里的ERNIE是百度提出的一个预训练语言模型，在这基础上再加上<code>Bi-LSTM+CRF</code>，同时抽取多个属性。如图所示，该流程是先进行一次事件句的识别，找到关于某个事件的句子。然后，再对这个句子进行多属性联合抽取，并对<code>抽取的结果进行归一</code>。地点归一到<code>国家、省市区县</code>等，<code>时间进行规范化</code>、<code>参与者实体化</code>等等。</p>
<p><img src="https://pic.cnwebe.com/wp-content/uploads/2020/11/20201125Kslljv.jpg" alt="通用属性抽取"></p>
<h2 id="自定义论元抽取"><a href="#自定义论元抽取" class="headerlink" title="自定义论元抽取"></a>自定义论元抽取</h2><p>自定义论元抽取要解决的问题就是如何根据用户定义的角色少样本甚至零样本地进行事件抽取。我们的方案是基于<code>阅读理解问答</code>的事件抽取模型。</p>
<p>我们把整个事件抽取的流程分成三轮问答：</p>
<p>第一轮，问触发词，抽取出输入事件句的触发词是什么。<br>第二轮，问整个输入句子的事件类型。<br>第三轮，是根据第二步抽取的结果，对该事件类型对应的每个角色进行问答抽取。<br>这个方案中，角色、事件类型这些本来跟模型耦合的东西都解耦了，新的角色和事件类型只需要把它们放到问题中就可以抽取，从而实现少样本、甚至零样本的抽取。相关研究成果已被EMNLP Findings，2020收录。</p>
<h2 id="语义角色抽取"><a href="#语义角色抽取" class="headerlink" title="语义角色抽取"></a>语义角色抽取</h2><p>把它们解耦成一个类型和一系列的语义角色的。例如，<code>“收购”类型和角色“收购价格”、“被收购方”和“收购方”</code>是耦合的。如果把所有如“收购价格”、“被收购方”、“收购方”这样的类型角色转化为如<code>“数值”、“受事主体”、“实施主体”</code>这样的与类型解耦的<code>语义角色</code>，我们整体的角色数量就可以就可以从n*类型数这一数量级，降低到只有十几个语义角色的量级。</p>
<h1 id="关系抽取"><a href="#关系抽取" class="headerlink" title="关系抽取"></a>关系抽取</h1><p>事件之间存在多种关系。我们目前定义了4种关系，包括<code>从属关系</code>、<code>共指关系</code>、<code>时序关系</code>和<code>因果关系</code>。由于时间的关系，我本次只分享因果关系。</p>
<ul>
<li>首先，因果关系在客观上是非常难判定的，不同人对因果有不同理解。因此，我们把因果关系当作观点来看待，直接绕过这个正确性的问题。通过因果的出现次数、来源的权威性等方面来评价抽取出的因果的质量。</li>
<li>第二，将因果关系作为序列标注问题，同时去标注多因多果，部分解决上面提到的复杂的、多因多果问题。</li>
<li>第三，对存在因果稀疏的问题。虽然在不同的语料中存在的因果关系是比较少的，但通过归一的方法我们可以将单独存在于多个不同地方的因果表达聚合到同一个网络图谱中，从而形成一个完整的因果图谱。</li>
</ul>
<p><img src="https://pic.cnwebe.com/wp-content/uploads/2020/11/20201125M451aC.jpg"></p>
<h1 id="事理图谱"><a href="#事理图谱" class="headerlink" title="事理图谱"></a>事理图谱</h1><p><img src="https://pic.cnwebe.com/wp-content/uploads/2020/11/20201125FKzMrn.jpg"></p>
<p>如果说我们需要进行推理的事件在因果语料中不存在，那我们应该怎么样进行推理和挖掘呢？目前我们正在尝试的3个思路如下：</p>
<ul>
<li><p>基于<code>事理</code>的推理。我们认为的事件是客观世界中发生的某个具体事件，抽象事件则是对一类事件的抽象，而事理则是这些抽象事件的因果规律。比如，“某一天美国加息”，就是美国在具体某一天的加息，而“美国加息”事件则是对这一类事件的抽象。由于“美国加息”这类事件常常会导致“美元的汇率上升”这样的抽象事件发生，那么，新的一次美国加息事件，也非常有可能导致汇率上升。这种抽象后的事件规律，我们会把它放在事理图谱层次，来支持<code>泛化的推理</code>。</p>
</li>
<li><p>基于<code>规则</code>的推理。举个例子，“生猪库存不足”会导致“猪肉价格上涨”。在这里面，两个主体“生猪”和“猪肉”，其实是存在产业链关系的。“生猪”是上游，“猪肉”是下游。通过观察一系列的类似的因果，我们可以挖掘出这样一个规则：上游的库存不足，可能会导致下游的价格上涨。那么面对一种新事件的时候，比如说钢铁库存不足，我们就可以推理预测下游一些钢铁产品的价格可能会上涨。</p>
</li>
<li><p>基于图神经网络的因果的预测。上面两种方法中，本质上都可以认为是一种简单的规则方法，当事件较为复杂，或者需要<code>多步推理</code>时，上面的方法就不能适用。例如，“网曝黄光裕即将出狱”可能导致了“国美”股票大涨。这中间存在了多步推理关系，首先是“黄光裕”出狱的这个事件的“出狱者”是“黄光裕”，而“黄光裕”是“国美”的一个重要高管，然后 “国美”对应的股票出现“大涨”事件。这是一个多步推理的过程，比较难以通过事件抽象或是规则进行建模。我们正在尝试将<code>每一个事件节点都放到整个图当中</code>去进行考虑。通过图的方式对这里面的事件节点进行<code>边的预测</code>。</p>
</li>
</ul>
<h1 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h1><p><img src="https://pic.cnwebe.com/wp-content/uploads/2020/11/20201125fuOixV.jpg"></p>
<h2 id="事件脉络"><a href="#事件脉络" class="headerlink" title="事件脉络"></a>事件脉络</h2><p><img src="https://pic.cnwebe.com/wp-content/uploads/2020/11/20201125vPCNIi.jpg"></p>
<h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><ul>
<li><a target="_blank" rel="noopener" href="https://www.cnwebe.com/articles/157267.html">https://www.cnwebe.com/articles/157267.html</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/09/07/biyelunwen/0_baidu/" data-id="cl85d5h2q000hi99ofrhc1hmi" data-title="百度事件图谱研究总结" class="article-share-link">Teilen</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%AF%95%E4%B8%9A%E8%AE%BA%E6%96%87/" rel="tag">毕业论文</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-leetcode/1179" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/09/07/leetcode/1179/" class="article-date">
  <time class="dt-published" datetime="2021-09-07T02:49:01.000Z" itemprop="datePublished">2021-09-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/leetcode/">leetcode</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/09/07/leetcode/1179/">1179-格式化部门表</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">部门表 Department：</span><br><span class="line"></span><br><span class="line">+---------------+---------+</span><br><span class="line">| Column Name   | Type    |</span><br><span class="line">+---------------+---------+</span><br><span class="line">| id            | int     |</span><br><span class="line">| revenue       | int     |</span><br><span class="line">| month         | varchar |</span><br><span class="line">+---------------+---------+</span><br><span class="line">(id, month) 是表的联合主键。</span><br><span class="line">这个表格有关于每个部门每月收入的信息。</span><br><span class="line">月份（month）可以取下列值 [&quot;Jan&quot;,&quot;Feb&quot;,&quot;Mar&quot;,&quot;Apr&quot;,&quot;May&quot;,&quot;Jun&quot;,&quot;Jul&quot;,&quot;Aug&quot;,&quot;Sep&quot;,&quot;Oct&quot;,&quot;Nov&quot;,&quot;Dec&quot;]。</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">编写一个 SQL 查询来重新格式化表，使得新的表中有一个部门 id 列和一些对应 每个月 的收入（revenue）列。</span><br><span class="line"></span><br><span class="line">查询结果格式如下面的示例所示：</span><br><span class="line"></span><br><span class="line">Department 表：</span><br><span class="line">+------+---------+-------+</span><br><span class="line">| id   | revenue | month |</span><br><span class="line">+------+---------+-------+</span><br><span class="line">| 1    | 8000    | Jan   |</span><br><span class="line">| 2    | 9000    | Jan   |</span><br><span class="line">| 3    | 10000   | Feb   |</span><br><span class="line">| 1    | 7000    | Feb   |</span><br><span class="line">| 1    | 6000    | Mar   |</span><br><span class="line">+------+---------+-------+</span><br><span class="line"></span><br><span class="line">查询得到的结果表：</span><br><span class="line">+------+-------------+-------------+-------------+-----+-------------+</span><br><span class="line">| id   | Jan_Revenue | Feb_Revenue | Mar_Revenue | ... | Dec_Revenue |</span><br><span class="line">+------+-------------+-------------+-------------+-----+-------------+</span><br><span class="line">| 1    | 8000        | 7000        | 6000        | ... | null        |</span><br><span class="line">| 2    | 9000        | null        | null        | ... | null        |</span><br><span class="line">| 3    | null        | 10000       | null        | ... | null        |</span><br><span class="line">+------+-------------+-------------+-------------+-----+-------------+</span><br><span class="line"></span><br><span class="line">注意，结果表有 13 列 (1个部门 id 列 + 12个月份的收入列)。</span><br><span class="line"></span><br><span class="line">来源：力扣（LeetCode）</span><br><span class="line">链接：https://leetcode-cn.com/problems/reformat-department-table</span><br><span class="line">著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</span><br></pre></td></tr></table></figure>

<blockquote>
<p>行转列使用<code>group by</code>配合上<code>count</code>或者<code>sum</code>来使用。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    id,</span><br><span class="line">    <span class="built_in">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> <span class="keyword">month</span> <span class="operator">=</span> <span class="string">&#x27;Jan&#x27;</span> <span class="keyword">then</span> revenue <span class="keyword">else</span> <span class="keyword">null</span> <span class="keyword">end</span>) <span class="keyword">as</span> Jan_Revenue,</span><br><span class="line">    <span class="built_in">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> <span class="keyword">month</span> <span class="operator">=</span> <span class="string">&#x27;Feb&#x27;</span> <span class="keyword">then</span> revenue <span class="keyword">else</span> <span class="keyword">null</span> <span class="keyword">end</span>) <span class="keyword">as</span> Feb_Revenue,</span><br><span class="line">    <span class="built_in">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> <span class="keyword">month</span> <span class="operator">=</span> <span class="string">&#x27;Mar&#x27;</span> <span class="keyword">then</span> revenue <span class="keyword">else</span> <span class="keyword">null</span> <span class="keyword">end</span>) <span class="keyword">as</span> Mar_Revenue,</span><br><span class="line">    <span class="built_in">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> <span class="keyword">month</span> <span class="operator">=</span> <span class="string">&#x27;Apr&#x27;</span> <span class="keyword">then</span> revenue <span class="keyword">else</span> <span class="keyword">null</span> <span class="keyword">end</span>) <span class="keyword">as</span> Apr_Revenue,</span><br><span class="line">    <span class="built_in">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> <span class="keyword">month</span> <span class="operator">=</span> <span class="string">&#x27;May&#x27;</span> <span class="keyword">then</span> revenue <span class="keyword">else</span> <span class="keyword">null</span> <span class="keyword">end</span>) <span class="keyword">as</span> May_Revenue,</span><br><span class="line">    <span class="built_in">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> <span class="keyword">month</span> <span class="operator">=</span> <span class="string">&#x27;Jun&#x27;</span> <span class="keyword">then</span> revenue <span class="keyword">else</span> <span class="keyword">null</span> <span class="keyword">end</span>) <span class="keyword">as</span> Jun_Revenue,</span><br><span class="line">    <span class="built_in">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> <span class="keyword">month</span> <span class="operator">=</span> <span class="string">&#x27;Jul&#x27;</span> <span class="keyword">then</span> revenue <span class="keyword">else</span> <span class="keyword">null</span> <span class="keyword">end</span>) <span class="keyword">as</span> Jul_Revenue,</span><br><span class="line">    <span class="built_in">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> <span class="keyword">month</span> <span class="operator">=</span> <span class="string">&#x27;Aug&#x27;</span> <span class="keyword">then</span> revenue <span class="keyword">else</span> <span class="keyword">null</span> <span class="keyword">end</span>) <span class="keyword">as</span> Aug_Revenue,</span><br><span class="line">    <span class="built_in">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> <span class="keyword">month</span> <span class="operator">=</span> <span class="string">&#x27;Sep&#x27;</span> <span class="keyword">then</span> revenue <span class="keyword">else</span> <span class="keyword">null</span> <span class="keyword">end</span>) <span class="keyword">as</span> Sep_Revenue,</span><br><span class="line">    <span class="built_in">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> <span class="keyword">month</span> <span class="operator">=</span> <span class="string">&#x27;Oct&#x27;</span> <span class="keyword">then</span> revenue <span class="keyword">else</span> <span class="keyword">null</span> <span class="keyword">end</span>) <span class="keyword">as</span> Oct_Revenue,</span><br><span class="line">    <span class="built_in">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> <span class="keyword">month</span> <span class="operator">=</span> <span class="string">&#x27;Nov&#x27;</span> <span class="keyword">then</span> revenue <span class="keyword">else</span> <span class="keyword">null</span> <span class="keyword">end</span>) <span class="keyword">as</span> Nov_Revenue,</span><br><span class="line">    <span class="built_in">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> <span class="keyword">month</span> <span class="operator">=</span> <span class="string">&#x27;Dec&#x27;</span> <span class="keyword">then</span> revenue <span class="keyword">else</span> <span class="keyword">null</span> <span class="keyword">end</span>) <span class="keyword">as</span> Dec_Revenue</span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">    Department</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span></span><br><span class="line">    id</span><br></pre></td></tr></table></figure>

<blockquote>
<p>不用在sum上再加上<code>ifnull</code>，多此一举。</p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/09/07/leetcode/1179/" data-id="cl85d5h34001mi99oe66y9t9p" data-title="1179-格式化部门表" class="article-share-link">Teilen</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SQL/" rel="tag">SQL</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/leetcode/" rel="tag">leetcode</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-leetcode/1164" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/09/06/leetcode/1164/" class="article-date">
  <time class="dt-published" datetime="2021-09-06T09:21:21.000Z" itemprop="datePublished">2021-09-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/leetcode/">leetcode</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/09/06/leetcode/1164/">1164题-指定日期的产品价格</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">产品数据表: Products</span><br><span class="line"></span><br><span class="line">+---------------+---------+</span><br><span class="line">| Column Name   | Type    |</span><br><span class="line">+---------------+---------+</span><br><span class="line">| product_id    | int     |</span><br><span class="line">| new_price     | int     |</span><br><span class="line">| change_date   | date    |</span><br><span class="line">+---------------+---------+</span><br><span class="line">这张表的主键是 (product_id, change_date)。</span><br><span class="line">这张表的每一行分别记录了 某产品 在某个日期 更改后 的新价格。</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">写一段 SQL来查找在 2019-08-16 时全部产品的价格，假设所有产品在修改前的价格都是 10。</span><br><span class="line"></span><br><span class="line">查询结果格式如下例所示：</span><br><span class="line"></span><br><span class="line">Products table:</span><br><span class="line">+------------+-----------+-------------+</span><br><span class="line">| product_id | new_price | change_date |</span><br><span class="line">+------------+-----------+-------------+</span><br><span class="line">| 1          | 20        | 2019-08-14  |</span><br><span class="line">| 2          | 50        | 2019-08-14  |</span><br><span class="line">| 1          | 30        | 2019-08-15  |</span><br><span class="line">| 1          | 35        | 2019-08-16  |</span><br><span class="line">| 2          | 65        | 2019-08-17  |</span><br><span class="line">| 3          | 20        | 2019-08-18  |</span><br><span class="line">+------------+-----------+-------------+</span><br><span class="line"></span><br><span class="line">Result table:</span><br><span class="line">+------------+-------+</span><br><span class="line">| product_id | price |</span><br><span class="line">+------------+-------+</span><br><span class="line">| 2          | 50    |</span><br><span class="line">| 1          | 35    |</span><br><span class="line">| 3          | 10    |</span><br><span class="line">+------------+-------+</span><br><span class="line"></span><br><span class="line">来源：力扣（LeetCode）</span><br><span class="line">链接：https://leetcode-cn.com/problems/product-price-at-a-given-date</span><br><span class="line">著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</span><br></pre></td></tr></table></figure>

<h1 id="解题"><a href="#解题" class="headerlink" title="解题"></a>解题</h1><blockquote>
<p>找到<code>2019-08-16</code>之前有改动的产品以及最新价格以及<code>没有修改过价格的产品</code>。2019年8月16号过后的肯定为10</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">    a.product_id,</span><br><span class="line">    ifnull(b.new_price, <span class="number">10</span>)</span><br><span class="line"><span class="keyword">from</span> (</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        <span class="keyword">distinct</span> product_id</span><br><span class="line">    <span class="keyword">from</span></span><br><span class="line">        Products</span><br><span class="line">) <span class="keyword">as</span> a</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> (</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        product_id, </span><br><span class="line">        new_price</span><br><span class="line">    <span class="keyword">from</span> </span><br><span class="line">        Products</span><br><span class="line">    <span class="keyword">where</span></span><br><span class="line">        (product_id, change_date) <span class="keyword">in</span> (</span><br><span class="line">            <span class="keyword">select</span></span><br><span class="line">                product_id,</span><br><span class="line">                <span class="built_in">min</span>(change_date) <span class="keyword">as</span> change_date <span class="comment">-- 最近一次的日期</span></span><br><span class="line">            <span class="keyword">from</span></span><br><span class="line">                Products</span><br><span class="line">            <span class="keyword">where</span></span><br><span class="line">                change_date <span class="operator">&lt;=</span> <span class="string">&#x27;2019-08-16&#x27;</span></span><br><span class="line">            <span class="keyword">group</span> <span class="keyword">by</span></span><br><span class="line">                product_id</span><br><span class="line">        )</span><br><span class="line">) <span class="keyword">as</span> b</span><br><span class="line"><span class="keyword">on</span></span><br><span class="line">    a.product_id <span class="operator">=</span> b.product_id</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/09/06/leetcode/1164/" data-id="cl85d5h33001li99odv45531u" data-title="1164题-指定日期的产品价格" class="article-share-link">Teilen</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SQL/" rel="tag">SQL</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/leetcode/" rel="tag">leetcode</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-leetcode/user-purchase-platform" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/09/02/leetcode/user-purchase-platform/" class="article-date">
  <time class="dt-published" datetime="2021-09-02T08:35:48.000Z" itemprop="datePublished">2021-09-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/leetcode/">leetcode</a>►<a class="article-category-link" href="/categories/leetcode/sql/">sql</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/09/02/leetcode/user-purchase-platform/">1127-用户购买平台</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">支出表: Spending</span><br><span class="line"></span><br><span class="line">+-------------+---------+</span><br><span class="line">| Column Name | Type    |</span><br><span class="line">+-------------+---------+</span><br><span class="line">| user<span class="emphasis">_id     | int     |</span></span><br><span class="line"><span class="emphasis">| spend_</span>date  | date    |</span><br><span class="line">| platform    | enum    | </span><br><span class="line">| amount      | int     |</span><br><span class="line">+-------------+---------+</span><br><span class="line">这张表记录了用户在一个在线购物网站的支出历史，该在线购物平台同时拥有桌面端（&#x27;desktop&#x27;）和手机端（&#x27;mobile&#x27;）的应用程序。</span><br><span class="line">这张表的主键是 (user<span class="emphasis">_id, spend_</span>date, platform)。</span><br><span class="line">平台列 platform 是一种 ENUM ，类型为（&#x27;desktop&#x27;, &#x27;mobile&#x27;）。</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">写一段 SQL 来查找每天 仅 使用手机端用户、仅 使用桌面端用户和 同时 使用桌面端和手机端的用户人数和总支出金额。</span><br><span class="line"></span><br><span class="line">查询结果格式如下例所示：</span><br><span class="line"></span><br><span class="line">Spending table:</span><br><span class="line">+---------+------------+----------+--------+</span><br><span class="line">| user<span class="emphasis">_id | spend_</span>date | platform | amount |</span><br><span class="line">+---------+------------+----------+--------+</span><br><span class="line">| 1       | 2019-07-01 | mobile   | 100    |</span><br><span class="line">| 1       | 2019-07-01 | desktop  | 100    |</span><br><span class="line">| 2       | 2019-07-01 | mobile   | 100    |</span><br><span class="line">| 2       | 2019-07-02 | mobile   | 100    |</span><br><span class="line">| 3       | 2019-07-01 | desktop  | 100    |</span><br><span class="line">| 3       | 2019-07-02 | desktop  | 100    |</span><br><span class="line">+---------+------------+----------+--------+</span><br><span class="line"></span><br><span class="line">Result table:</span><br><span class="line">+------------+----------+--------------+-------------+</span><br><span class="line">| spend<span class="emphasis">_date | platform | total_</span>amount | total<span class="emphasis">_users |</span></span><br><span class="line"><span class="emphasis">+------------+----------+--------------+-------------+</span></span><br><span class="line"><span class="emphasis">| 2019-07-01 | desktop  | 100          | 1           |</span></span><br><span class="line"><span class="emphasis">| 2019-07-01 | mobile   | 100          | 1           |</span></span><br><span class="line"><span class="emphasis">| 2019-07-01 | both     | 200          | 1           |</span></span><br><span class="line"><span class="emphasis">| 2019-07-02 | desktop  | 100          | 1           |</span></span><br><span class="line"><span class="emphasis">| 2019-07-02 | mobile   | 100          | 1           |</span></span><br><span class="line"><span class="emphasis">| 2019-07-02 | both     | 0            | 0           |</span></span><br><span class="line"><span class="emphasis">+------------+----------+--------------+-------------+ </span></span><br><span class="line"><span class="emphasis">在 2019-07-01, 用户1 同时 使用桌面端和手机端购买, 用户2 仅 使用了手机端购买，而用户3 仅 使用了桌面端购买。</span></span><br><span class="line"><span class="emphasis">在 2019-07-02, 用户2 仅 使用了手机端购买, 用户3 仅 使用了桌面端购买，且没有用户 同时 使用桌面端和手机端购买。</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">来源：力扣（LeetCode）</span></span><br><span class="line"><span class="emphasis">链接：https://leetcode-cn.com/problems/user-purchase-platform</span></span><br><span class="line"><span class="emphasis">著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</span></span><br><span class="line"><span class="emphasis"></span></span><br></pre></td></tr></table></figure>

<h1 id="解题"><a href="#解题" class="headerlink" title="解题"></a>解题</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">with</span> to_join <span class="keyword">as</span> (</span><br><span class="line">    <span class="comment">-- 建立底表</span></span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        <span class="keyword">distinct</span> spend_date, <span class="string">&#x27;desktop&#x27;</span> <span class="keyword">as</span> platform</span><br><span class="line">    <span class="keyword">from</span></span><br><span class="line">        Spending</span><br><span class="line">    <span class="keyword">union</span></span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        <span class="keyword">distinct</span> spend_date, <span class="string">&#x27;mobile&#x27;</span> <span class="keyword">as</span> platform</span><br><span class="line">    <span class="keyword">from</span></span><br><span class="line">        Spending</span><br><span class="line">    <span class="keyword">union</span></span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        <span class="keyword">distinct</span> spend_date, <span class="string">&#x27;both&#x27;</span> <span class="keyword">as</span> platform</span><br><span class="line">    <span class="keyword">from</span></span><br><span class="line">        Spending</span><br><span class="line">),</span><br><span class="line">base <span class="keyword">as</span> (</span><br><span class="line">    <span class="comment">-- 统计每一个日期每一个用户登录的平台类型以及开销</span></span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        spend_date,</span><br><span class="line">        user_id,</span><br><span class="line">        <span class="built_in">sum</span>(amount) <span class="keyword">as</span> amount,</span><br><span class="line">        if(<span class="built_in">count</span>(<span class="operator">*</span>) <span class="operator">=</span> <span class="number">1</span>, platform, <span class="string">&#x27;both&#x27;</span>) <span class="keyword">as</span> platform <span class="comment">-- 判断平台类型</span></span><br><span class="line">    <span class="keyword">from</span></span><br><span class="line">        Spending</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span></span><br><span class="line">        spend_date,</span><br><span class="line">        user_id</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">    a.spend_date,</span><br><span class="line">    a.platform,</span><br><span class="line">    ifnull(<span class="built_in">sum</span>(b.amount), <span class="number">0</span>) <span class="keyword">as</span> total_amount,</span><br><span class="line">    ifnull(<span class="built_in">count</span>(<span class="keyword">distinct</span> b.user_id), <span class="number">0</span>) <span class="keyword">as</span> total_users</span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">    to_join <span class="keyword">as</span> a</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span></span><br><span class="line">    base <span class="keyword">as</span> b</span><br><span class="line"><span class="keyword">on</span></span><br><span class="line">    a.spend_date <span class="operator">=</span> b.spend_date <span class="keyword">and</span></span><br><span class="line">    a.platform <span class="operator">=</span> b.platform</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span></span><br><span class="line">    a.spend_date,</span><br><span class="line">    a.platform</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>if(count(*) = 1, platform, &#39;both&#39;)</code>,这个用来判断平台类型是核心的要求</p>
</blockquote>
<h1 id="原来写的代码"><a href="#原来写的代码" class="headerlink" title="原来写的代码"></a>原来写的代码</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> whole_date <span class="keyword">as</span> (</span><br><span class="line">    <span class="comment">-- 所有日期</span></span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        <span class="keyword">distinct</span> spend_date</span><br><span class="line">    <span class="keyword">from</span></span><br><span class="line">        Spending</span><br><span class="line">), </span><br><span class="line">base <span class="keyword">as</span> (</span><br><span class="line">    <span class="comment">-- 手机端</span></span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        <span class="operator">*</span>,</span><br><span class="line">        <span class="built_in">count</span>(platform) <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> spend_date, user_id) <span class="keyword">as</span> platform_num <span class="comment">-- 这一天根据当前的platform分组后的数量</span></span><br><span class="line">    <span class="keyword">from</span></span><br><span class="line">        Spending</span><br><span class="line">),</span><br><span class="line">mobile <span class="keyword">as</span> (</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        spend_date,</span><br><span class="line">        <span class="string">&#x27;mobile&#x27;</span> <span class="keyword">as</span> platform,</span><br><span class="line">        <span class="built_in">sum</span>(amount) <span class="keyword">as</span> total_amount,</span><br><span class="line">        <span class="built_in">count</span>(<span class="keyword">distinct</span> user_id) <span class="keyword">as</span> total_users</span><br><span class="line">    <span class="keyword">from</span></span><br><span class="line">        base</span><br><span class="line">    <span class="keyword">where</span></span><br><span class="line">        platform <span class="operator">=</span> <span class="string">&#x27;mobile&#x27;</span> <span class="keyword">and</span> platform_num <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span></span><br><span class="line">        spend_date</span><br><span class="line">),</span><br><span class="line">desktop <span class="keyword">as</span> (</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        spend_date,</span><br><span class="line">        <span class="string">&#x27;desktop&#x27;</span> <span class="keyword">as</span> platform,</span><br><span class="line">        <span class="built_in">sum</span>(amount) <span class="keyword">as</span> total_amount,</span><br><span class="line">        <span class="built_in">count</span>(<span class="keyword">distinct</span> user_id) <span class="keyword">as</span> total_users</span><br><span class="line">    <span class="keyword">from</span></span><br><span class="line">        base</span><br><span class="line">    <span class="keyword">where</span></span><br><span class="line">        platform <span class="operator">=</span> <span class="string">&#x27;desktop&#x27;</span> <span class="keyword">and</span> platform_num <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span></span><br><span class="line">        spend_date   </span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">    a.spend_date,</span><br><span class="line">    b.platform,</span><br><span class="line">    ifnull(b.total_amount, <span class="number">0</span>) <span class="keyword">as</span> total_amount,</span><br><span class="line">    ifnull(b.total_users, <span class="number">0</span>) <span class="keyword">as</span> total_users</span><br><span class="line"><span class="keyword">from</span>    </span><br><span class="line">    whole_date <span class="keyword">as</span> a</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span></span><br><span class="line">    mobile <span class="keyword">as</span> b</span><br><span class="line"><span class="keyword">on</span></span><br><span class="line">    a.spend_date <span class="operator">=</span> b.spend_date</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">    a.spend_date,</span><br><span class="line">    b.platform,</span><br><span class="line">    ifnull(b.total_amount, <span class="number">0</span>) <span class="keyword">as</span> total_amount,</span><br><span class="line">    ifnull(b.total_users, <span class="number">0</span>) <span class="keyword">as</span> total_users</span><br><span class="line"><span class="keyword">from</span>    </span><br><span class="line">    whole_date <span class="keyword">as</span> a</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span></span><br><span class="line">    desktop <span class="keyword">as</span> b</span><br><span class="line"><span class="keyword">on</span></span><br><span class="line">    a.spend_date <span class="operator">=</span> b.spend_date</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">    a.spend_date,</span><br><span class="line">    ifnull(b.platform, <span class="string">&#x27;both&#x27;</span>),</span><br><span class="line">    ifnull(b.total_amount, <span class="number">0</span>) <span class="keyword">as</span> total_amount,</span><br><span class="line">    ifnull(b.total_users, <span class="number">0</span>) <span class="keyword">as</span> total_users</span><br><span class="line"><span class="keyword">from</span>    </span><br><span class="line">    whole_date <span class="keyword">as</span> a</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> (</span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        spend_date,</span><br><span class="line">        <span class="string">&#x27;both&#x27;</span> <span class="keyword">as</span> platform,</span><br><span class="line">        <span class="built_in">sum</span>(amount) <span class="keyword">as</span> total_amount,</span><br><span class="line">        <span class="built_in">count</span>(<span class="keyword">distinct</span> user_id) <span class="keyword">as</span> total_users</span><br><span class="line">    <span class="keyword">from</span></span><br><span class="line">        base</span><br><span class="line">    <span class="keyword">where</span>   </span><br><span class="line">        platform_num <span class="operator">=</span> <span class="number">2</span></span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span></span><br><span class="line">        spend_date</span><br><span class="line">) <span class="keyword">as</span> b</span><br><span class="line"><span class="keyword">on</span></span><br><span class="line">    a.spend_date <span class="operator">=</span> b.spend_date</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span></span><br><span class="line">    spend_date,</span><br><span class="line">    field(platform, <span class="string">&#x27;desktop&#x27;</span>, <span class="string">&#x27;mobile&#x27;</span>, <span class="string">&#x27;both&#x27;</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>过于臃肿，计算麻烦，很容易出错，出错也不容易去修改</p>
</blockquote>
<h1 id="Write-your-MySQL-query-statement-below"><a href="#Write-your-MySQL-query-statement-below" class="headerlink" title="Write your MySQL query statement below"></a>Write your MySQL query statement below</h1><p>–报告为垃圾广告的帖子<br>with base as (<br>    select<br>        a.*,<br>        if(b.remove_date is null, 0, 1) as if_remove<br>    from<br>        Actions as a<br>    left join<br>        Removals as b<br>    on<br>        a.post_id = b.post_id<br>)</p>
<p>select<br>    round(avg(p) * 100, 4)<br>from (<br>    select<br>        action_date,<br>        sum(if_remove) / count(distinct post_id) as p<br>    from<br>        base<br>    where<br>        action = ‘report’ and<br>        extra = ‘spam’<br>    group by<br>        action_date<br>) as a</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/09/02/leetcode/user-purchase-platform/" data-id="cl85d5h3j002li99ohrjt437i" data-title="1127-用户购买平台" class="article-share-link">Teilen</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/leetcode/" rel="tag">leetcode</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sql/" rel="tag">sql</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/6/">&laquo; zurück</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><span class="page-number current">7</span><a class="page-number" href="/page/8/">8</a><a class="page-number" href="/page/9/">9</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/">17</a><a class="extend next" rel="next" href="/page/8/">weiter &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Kategorien</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CV/">-CV</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Django/">Django</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Leetcode/">Leetcode</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/NLP/">NLP</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/SQL/">SQL</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/django/">django</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/leetcode/">leetcode</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/leetcode/sql/">sql</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%B8%9A%E5%8A%A1/">业务</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%B8%9A%E5%8A%A1%E6%8C%87%E6%A0%87/">业务指标</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%B8%AD%E4%BF%A1%E8%AF%81%E5%88%B8/">中信证券</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%85%B6%E4%BB%96/">其他</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%85%B6%E4%BB%96/Django/">Django</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/Flume/">Flume</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E9%9B%86/">数据集</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%AF%95%E4%B8%9A%E8%AE%BA%E6%96%87/">毕业论文</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/">毕业设计</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%88%AC%E8%99%AB/">爬虫</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%A7%8B%E6%8B%9B/">秋招</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%A7%8B%E6%8B%9B/%E9%9D%A2%E8%AF%95/">面试</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AC%94%E8%AF%95/">笔试</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BB%9F%E8%AE%A1%E5%AD%A6/">统计学</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AE%BA%E6%96%87/">论文</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%87%91%E5%B1%B1%E5%AE%9E%E4%B9%A0/">金山实习</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%93%B6%E8%81%94%E5%AE%9E%E4%B9%A0/">银联实习</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%9D%A2%E8%AF%95/">面试</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/leetcode/" rel="tag">-leetcode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CV/" rel="tag">CV</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Django/" rel="tag">Django</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Flume/" rel="tag">Flume</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hbase/" rel="tag">Hbase</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NLP/" rel="tag">NLP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL/" rel="tag">SQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/django/" rel="tag">django</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/leetcode/" rel="tag">leetcode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sql/" rel="tag">sql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%9A%E5%8A%A1/" rel="tag">业务</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%AD%E4%BF%A1%E8%AF%81%E5%88%B8/" rel="tag">中信证券</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%85%B6%E4%BB%96/" rel="tag">其他</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/" rel="tag">大数据</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%9E%E4%B9%A0/" rel="tag">实习</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B7%A5%E4%BD%9C/" rel="tag">工作</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="tag">数据结构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E9%9B%86/" rel="tag">数据集</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E9%A2%84%E6%B5%8B/" rel="tag">时间序列预测</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" rel="tag">机器学习</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%AF%95%E4%B8%9A%E8%AE%BA%E6%96%87/" rel="tag">毕业论文</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/" rel="tag">毕业设计</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%88%AC%E8%99%AB/" rel="tag">爬虫</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%A7%8B%E6%8B%9B/" rel="tag">秋招</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AC%94%E8%AF%95/" rel="tag">笔试</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BB%9F%E8%AE%A1%E5%AD%A6/" rel="tag">统计学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BA%E6%96%87/" rel="tag">论文</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%87%91%E5%B1%B1%E5%AE%9E%E4%B9%A0/" rel="tag">金山实习</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%93%B6%E8%81%94%E5%AE%9E%E4%B9%A0/" rel="tag">银联实习</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%A2%E8%AF%95/" rel="tag">面试</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/leetcode/" style="font-size: 10px;">-leetcode</a> <a href="/tags/CV/" style="font-size: 10px;">CV</a> <a href="/tags/Django/" style="font-size: 13.33px;">Django</a> <a href="/tags/Flume/" style="font-size: 10px;">Flume</a> <a href="/tags/Hbase/" style="font-size: 10px;">Hbase</a> <a href="/tags/NLP/" style="font-size: 10px;">NLP</a> <a href="/tags/SQL/" style="font-size: 18.89px;">SQL</a> <a href="/tags/django/" style="font-size: 10px;">django</a> <a href="/tags/leetcode/" style="font-size: 15.56px;">leetcode</a> <a href="/tags/sql/" style="font-size: 10px;">sql</a> <a href="/tags/%E4%B8%9A%E5%8A%A1/" style="font-size: 13.33px;">业务</a> <a href="/tags/%E4%B8%AD%E4%BF%A1%E8%AF%81%E5%88%B8/" style="font-size: 11.11px;">中信证券</a> <a href="/tags/%E5%85%B6%E4%BB%96/" style="font-size: 20px;">其他</a> <a href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/" style="font-size: 13.33px;">大数据</a> <a href="/tags/%E5%AE%9E%E4%B9%A0/" style="font-size: 16.67px;">实习</a> <a href="/tags/%E5%B7%A5%E4%BD%9C/" style="font-size: 11.11px;">工作</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 10px;">数据结构</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E9%9B%86/" style="font-size: 10px;">数据集</a> <a href="/tags/%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E9%A2%84%E6%B5%8B/" style="font-size: 10px;">时间序列预测</a> <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" style="font-size: 12.22px;">机器学习</a> <a href="/tags/%E6%AF%95%E4%B8%9A%E8%AE%BA%E6%96%87/" style="font-size: 14.44px;">毕业论文</a> <a href="/tags/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/" style="font-size: 10px;">毕业设计</a> <a href="/tags/%E7%88%AC%E8%99%AB/" style="font-size: 12.22px;">爬虫</a> <a href="/tags/%E7%A7%8B%E6%8B%9B/" style="font-size: 13.33px;">秋招</a> <a href="/tags/%E7%AC%94%E8%AF%95/" style="font-size: 12.22px;">笔试</a> <a href="/tags/%E7%BB%9F%E8%AE%A1%E5%AD%A6/" style="font-size: 12.22px;">统计学</a> <a href="/tags/%E8%AE%BA%E6%96%87/" style="font-size: 11.11px;">论文</a> <a href="/tags/%E9%87%91%E5%B1%B1%E5%AE%9E%E4%B9%A0/" style="font-size: 13.33px;">金山实习</a> <a href="/tags/%E9%93%B6%E8%81%94%E5%AE%9E%E4%B9%A0/" style="font-size: 10px;">银联实习</a> <a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size: 17.78px;">面试</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archiv</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">May 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">May 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">March 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">letzter Beitrag</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/05/14/other/time_series_pred/">时间序列预测</a>
          </li>
        
          <li>
            <a href="/2023/05/01/other/customer_analysis_in_python/">用户价值分析</a>
          </li>
        
          <li>
            <a href="/2022/06/15/other/PEP8/">PEP-8: Python代码规范</a>
          </li>
        
          <li>
            <a href="/2022/05/29/other/fanqie/">番茄工作法</a>
          </li>
        
          <li>
            <a href="/2022/05/20/citics/neo4j_query_optimize/">neo4j查询调优</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>